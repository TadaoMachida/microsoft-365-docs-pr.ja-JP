---
title: Office 365 の NAT サポート
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 1/24/2017
audience: Admin
ms.topic: overview
ms.service: o365-administration
localization_priority: Normal
ms.collection: Ent_O365
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- BCS160
ms.assetid: 170e96ea-d65d-4e51-acac-1de56abe39b9
description: この記事では、NAT を使用して組織内の IP アドレスごとに使用できるクライアント数を概算する方法の詳細を示します。
ms.openlocfilehash: f48874853c3acb80927933761862b14379b6d4bd
ms.sourcegitcommit: d08fe0282be75483608e96df4e6986d346e97180
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/12/2021
ms.locfileid: "59210644"
---
# <a name="nat-support-with-office-365"></a>Office 365 の NAT サポート

*この記事は、Microsoft 365 Enterprise および Office 365 Enterprise の両方に適用されます。*

ガイダンスでは以前、Office 365 に接続するために IP アドレスごとに使用する必要がある Exchange クライアントの最大数は、ネットワーク ポート 1 つあたり約 2,000 と推奨していました。
  
## <a name="why-use-nat"></a>NAT を使用する理由は何ですか。

NAT の使用により、企業ネットワークの何千人ものユーザーが、少数のパブリック ルーティング可能な IP アドレスを「共有」することができます。
  
ほとんどの企業ネットワークは、プライベート (RFC1918) の IP アドレス空間を使用しています。プライベートアドレス空間は Internet Assigned Numbers Authority (IANA) によって割り当てられたもので、グローバル インターネットに直接つながっていないネットワークのみを想定しています。
  
プライベート IP アドレス空間上のデバイスにインターネット アクセスを提供するには、ネットワーク アドレス変換 (NAT) またはポート アドレス変換 (PAT) サービスを提供するファイアウォールおよびプロキシのようなゲートウェイ技術を使用します。これらのゲートウェイは、内部デバイスからインターネットへのトラフィック (Office 365 など) を、1 つまたは複数のパブリック ルーティング可能な IP アドレスから来ているように見せます。内部デバイス変換から各アウトバウンド接続はパブリック IP アドレスの異なる送信元 TCP ポートに変換されます。 
  
## <a name="why-do-you-need-to-have-so-many-connections-open-to-office-365-at-the-same-time"></a>Office 365 に対して多数の接続を同時に開く必要があるのはなぜですか。

Outlook 8 つ以上の接続を開く場合があります (アドイン、共有予定表、メールボックスなどがある場合)。 Windows ベースの NAT デバイスで使用できるポートは最大 64,000 個なので、ポートが使い果たされる前に、IP アドレスの背後に最大 8,000 人のユーザーが必要になる場合があります。 お客様が NAT に対して非 Windows OS ベースのデバイスを使用している場合、使用可能なポートの合計は、使用されている NAT デバイスまたはソフトウェアによって異なります。 このシナリオでは、ポートの最大数は 64,000 未満になる可能性があります。 ポートの可用性は、Windows が独自に使用するために 4,000 ポートを制限するなどの他の要因によっても影響を受け、使用可能なポートの総数は 60,000 に減少します。 他のアプリケーション (Internet Explorerなど) が同時に接続される場合があります。追加のポートが必要になる場合があります。
  
## <a name="calculating-maximum-supported-devices-behind-a-single-public-ip-address-with-office-365"></a>Office 365 で単一のパブリック IP アドレスにサポートされるデバイスの最大数の計算

単一のパブリック IP アドレスにあるデバイスの最大数を決定するには、ネットワーク トラフィックを監視し、クライアントごとのピーク ポート消費量を決定する必要があります。また、ポートの使用数にピーク係数を使用する必要があります (最小は 4)。 
  
 **IP アドレスごとにサポートされるデバイスの数を計算するには、次の式を使用します。**
  
単一のパブリック IP アドレスにサポートされるデバイスの最大数 = (64,000 - 制限されたポート) / (ピーク ポート消費量 + ピーク係数)
  
 **たとえば、次のような条件だとします。**
  
- **制限されたポート:** オペレーティング システムで 4,000

- **ピーク ポート消費量:** デバイスあたり 6

- **ピーク係数:** 4

このような条件の場合、単一のパブリック IP アドレスにサポートされるデバイスの最大数 = (64,000 - 4,000) / (6 + 4) = 6,000 
  
Office 365 ホスティング パック (Microsoft Office Outlook 2007 用の 2011 年 9 月の更新プログラム、Microsoft Outlook 2010 用の 2011 年 11 月の更新プログラム、またはそれ以降の更新プログラムに含まれています) のリリースでの、Outlook (Office Outlook 2007 Service Pack 2 と Outlook 2010 の両方) から Exchange への最小接続数は 2 つです。ピーク時のネットワークに必要な最小または最大のポート数を決定するには、異なるオペレーティング システムやユーザーの行動などを考慮する必要があります。
  
単一のパブリック IP アドレスでより多くのデバイスをサポートする場合、サポートできるデバイスの最大数を説明した手順に従って査定します。
  
クライアントごとのピーク ポート消費量を決定するために、ネットワーク トラフィックを監視します。このデータは次の要領で収集します。
  
- 複数の場所から収集する
    
- 複数のデバイスから収集する
    
- 複数回にわたって収集する
    
上記の計算式を使い、クライアントの環境でサポート可能な IP アドレスあたりの最大ユーザー数を計算します。
  
追加のパブリック IP アドレス間でクライアント負荷を分散するにはさまざまな方法があります。利用可能な方法は企業のゲートウェイ ソリューションの機能によって決まります。最も簡単な方法は、ユーザー アドレス空間をセグメントに分けて、静的に各ゲートウェイに IP アドレスの数を「割り当て」る方法です。多くのゲートウェイ デバイスでサポートされている別の方法としては、IP アドレスのプールの機能を使用できます。アドレス プールの利点は、非常に動的で、ユーザー ベースの増加に合わせて調整する必要があまりないということです。
  
## <a name="see-also"></a>関連項目

[Office 365 エンドポイントの管理](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)
  
[Office 365 エンドポイントの FAQ](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)
