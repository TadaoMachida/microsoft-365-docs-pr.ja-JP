---
title: 手順 1. SharePoint Syntexを使用してコントラクト ファイルを識別し、データを抽出する
ms.author: chucked
author: chuckedmonson
manager: pamgreen
ms.reviewer: ssquires
audience: admin
ms.topic: article
ms.date: ''
ms.prod: microsoft-365-enterprise
search.appverid: ''
ms.localizationpriority: medium
ROBOTS: ''
description: SharePoint Syntexを使用してコントラクト ファイルを識別し、Microsoft 365 ソリューションを使用してデータを抽出する方法について説明します。
ms.openlocfilehash: c654c72ef36bf86337b7564efc68e4523516f4f9
ms.sourcegitcommit: d4b867e37bf741528ded7fb289e4f6847228d2c5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/06/2021
ms.locfileid: "60173513"
---
# <a name="step-1-use-sharepoint-syntex-to-identify-contract-files-and-extract-data"></a>手順 1. SharePoint Syntexを使用してコントラクト ファイルを識別し、データを抽出する

組織には、受信した多くのファイルからすべてのコントラクト ドキュメントを識別して分類する方法が必要です。 また、識別された各コントラクト ファイルのいくつかの重要な要素 ( *クライアント*、 *契約業者*、 *料金など*) を簡単に表示できるようにする必要もあります。 これを行うには、[SharePoint Syntex](index.md)を使用してドキュメント理解モデルを作成し、ドキュメント ライブラリに適用します。

## <a name="overview-of-the-process"></a>プロセスの概要

[ドキュメントの理解](document-understanding-overview.md) では、人工知能 (AI) モデルを使用して、ファイルの分類と情報の抽出を自動化します。 ドキュメント理解モデルは、必要な情報がコントラクトなどのテーブルやフォームに含まれていない非構造化ドキュメントや半構造化ドキュメントから情報を抽出する場合にも最適です。 

ドキュメント理解モデルは、光学式文字認識 (OCR) テクノロジーを使用して、PDF、画像、および TIFF ファイルをスキャンします。これは、サンプル ファイルを使用してモデルをトレーニングする場合と、ドキュメント ライブラリ内のファイルに対してモデルを実行する場合の両方です。

1. まず、モデルを "トレーニング" するために使用できる少なくとも 5 つのサンプル ファイルを見つけて、識別しようとしているコンテンツ タイプに固有の特性 (コントラクト) を検索する必要があります。 

2. SharePoint Syntexを使用して、新しいドキュメント理解モデルを作成します。 サンプル ファイルを使用して、 [分類子を作成する](create-a-classifier.md)必要があります。 サンプル ファイルを使用して分類子をトレーニングすることで、会社の契約に表示される特性に固有の特性を検索するように教えます。 たとえば、*サービス契約*、*契約条件*、報酬など、契約内の特定の文字列を検索する ["説明" を作成](create-a-classifier.md#create-an-explanation)*します*。 説明をトレーニングして、ドキュメントの特定のセクションでこれらの文字列を検索したり、他の文字列の横に配置したりすることもできます。 必要な情報を使用して分類子をトレーニングしたと思われる場合は、サンプル ファイルのサンプル セットでモデルをテストして、その効率を確認できます。 テスト後、必要に応じて説明を変更して、より効率的にすることができます。 

3. モデルでは、抽出 [器を作成](create-an-extractor.md) して、各コントラクトから特定のデータを取り出すことができます。 たとえば、契約ごとに、最も関心のある情報は、クライアントが誰であるか、請負業者の名前、合計コストです。

4. モデルを正常に作成したら、[それをSharePointドキュメント ライブラリに適用します](apply-a-model.md)。 ドキュメントライブラリにドキュメントをアップロードすると、ドキュメント理解モデルが実行され、モデルで定義したコントラクト コンテンツ タイプに一致するすべてのファイルが識別され、分類されます。 コントラクトとして分類されたすべてのファイルは、カスタム ライブラリ ビューに表示されます。 また、抽出器で定義した各コントラクトの値もファイルに表示されます。

   ![ドキュメント ライブラリ内のコントラクト。](../media/content-understanding/doc-lib-solution.png)

5. 契約の保有期間またはセキュリティ要件がある場合は、モデルを使用して [、保持ラベル](apply-a-retention-label-to-a-model.md) または [秘密度ラベル](apply-a-sensitivity-label-to-a-model.md) を適用して、指定した期間、またはコントラクトにアクセスできるユーザーを制限することができます。

## <a name="steps-to-create-and-train-your-model"></a>モデルを作成してトレーニングする手順

> [!NOTE]
> これらの手順では、 [Contracts Management Solution Assets リポジトリ](https://github.com/pnp/syntex-samples/tree/main/scenario%20assets/Contracts%20Management)のサンプル ファイルを使用できます。 このリポジトリの例には、ドキュメントの理解モデル ファイルと、モデルのトレーニングに使用されるファイルの両方が含まれています。

### <a name="create-a-contract-model"></a>コントラクト モデルを作成する

最初の手順は、コントラクト モデルを作成することです。

1. コンテンツ センターで、**[新規]** を選択し、**[モデルを作成する]** を選択します。

2. [ **新しいドキュメント理解モデル** ] ウィンドウの [ **名前** ] フィールドに、モデルの名前を入力します。 このコントラクト管理ソリューションでは *、モデルコントラクト* に名前を付けることができます。

4. **[作成]** を選択します。 これにより、モデルのホームページが作成されます。</br>

    ![[コントラクト] ホーム ページのスクリーンショット。](../media/content-understanding/models-contract-home-page.png)


### <a name="train-your-model-to-classify-a-type-of-file"></a>ファイルの種類を分類するようにモデルをトレーニングする

#### <a name="add-example-files-for-your-model"></a>モデルのサンプル ファイルを追加する

コントラクト ドキュメントである少なくとも 5 つのサンプル ファイルと、コントラクト ドキュメントではない 1 つのサンプル ファイル (たとえば、作業ステートメント) を追加する必要があります。 

1. [**モデル > コントラクト**] ページの [**Key actionsAdd** >  **example files**] で、[ファイルの **追加**] を選択します。

   ![[サンプル ファイルの追加] オプションが強調表示されている [Contracts] ページを示すスクリーンショット。](../media/content-understanding/key-actions-add-example-files.png)

2. [ **モデルのサンプル ファイルの選択]** ページで、[コントラクト] フォルダーを開き、使用するファイルを選択して、[ **追加**] を選択します。 サンプル ファイルがない場合は、**アップロード** を選択して追加します。

#### <a name="label-the-files-as-positive-or-negative-examples"></a>ファイルに正または負の例としてラベルを付ける

1. [**モデル > コントラクト**] ページの [Key **actionsClassify files and run training**] (**キー アクション** > クラス化ファイルとトレーニングの実行) で、[**分類子のトレーニング**] を選択します。

   ![[ファイルの分類とトレーニングの実行] オプションが強調表示された [Contracts] ページを示すスクリーンショット。](../media/content-understanding/key-actions-classify-files.png)

2. [ **モデル>コントラクト>コントラクト分類子** ] ページの最初のサンプル ファイルの上部にあるビューアーに、ファイルが作成したコントラクト モデルの例であるかどうかを確認するテキストが表示されます。 この例がポジティブの場合は、[ **はい**] を選択します。 ネガティブの例の場合は、[ **いいえ**] を選択します。

3. 左側の **[ラベル付き例** ] の一覧から、例として使用する他のファイルを選択し、ラベルを付けます。 

    ![分類子ホーム ページ。](../media/content-understanding/models-contract-classifier.png) 

#### <a name="add-at-least-one-explanation-to-train-the-classifier"></a>分類子をトレーニングするための説明を少なくとも 1 つ追加する 

1. [ **モデル>コントラクト>コントラクト分類子** ] ページで、[ **トレーニング** ] タブを選択します。

2. [ **トレーニング済みファイル** ] セクションには、以前にラベルを付けたサンプル ファイルの一覧が表示されます。 リストから正のファイルのいずれかを選択して、ビューアーに表示します。

3. [説明] セクション **で** 、[ **新規** ] を選択し、[空白] を選択 **します**。

4. [ **説明を作成する** ] ページで：

    a. [ **名前]** フィールドに説明の名前 ("契約" など) を入力します。

    b. テキスト文字列を追加するため、[ **説明の種類** ] フィールドで [ **フレーズ] ボックスの一覧** を選択します。

    c. **[フレーズ] ボックス** に文字列 ("AGREEMENT" など) を入力します。 文字列で **大文字と小文字を区別** する必要がある場合は、[大文字と小文字を区別する] を選択できます。

    d. **[保存してトレーニング] を選択します**。

    ![[説明の作成] パネルのスクリーンショット。](../media/content-understanding/contract-classifier-create-explanation.png) 

#### <a name="test-your-model"></a>モデルをテストする

コントラクト モデルは、前に見たことがないサンプル ファイルでテストできます。 これは省略可能ですが、便利なベスト プラクティスになる可能性があります。

1. [ **モデル>コントラクト>コントラクト分類子** ] ページで、[ **テスト** ] タブを選択します。これにより、ラベルのないサンプル ファイルでモデルが実行されます。

2. **[テスト ファイル**] の一覧で、サンプル ファイルが表示され、モデルが正または負であると予測したかどうかを示します。 この情報を使用して、ドキュメントを特定するときの分類子の有効性を判断します。

    ![[テキスト ファイル] ボックスの一覧のラベルが付いていないファイルのスクリーンショット。](../media/content-understanding/test-on-files.png) 

3. 完了したら、[ **トレーニングの終了**] を選択します。

### <a name="create-and-train-an-extractor"></a>抽出器を作成してトレーニングする

1. [**モデル > コントラクト**] ページの [**キー アクション**] の [**抽出器の作成とトレーニング**] で、[**抽出器の作成**] を選択します。 > 

   ![[抽出プログラムの作成とトレーニング] オプションが強調表示された [コントラクト] ページを示すスクリーンショット。](../media/content-understanding/key-actions-create-extractors.png)

2. [ **新しいエンティティ抽出ツール** ] パネルの [ **新しい名前** ] フィールドに抽出器の名前を入力します。 たとえば、各コントラクトから *クライアント* の名前を抽出する場合は、クライアントに名前を付けます。

3. 完了したら、[ **作成**] を選択します。

#### <a name="label-the-entity-you-want-to-extract"></a>抽出するエンティティにラベルを付ける

抽出器を作成すると、抽出器ページが開きます。 ここでは、サンプルファイルの一覧が表示されます。リストの最初のファイルは、viewer に表示されています。

![[クライアント抽出プログラムのラベル付けされた例] ページのスクリーンショット。](../media/content-understanding/client-extractor-labeled-examples.png) 

エンティティにラベルを付ける方法:

1. Viewer で、ファイルから抽出するデータを選択します。 たとえば、 *クライアント* を抽出する場合は、最初のファイル (この例では *[Best For You Organics*])でクライアント値を強調表示し、[保存] を選択 **します**。 [ラベル付け **された例** ] ボックスの一覧の [ **ラベル** ] 列に、ファイルの値が表示されます。

2. [ **次のファイル** ] を選択して自動保存し、ビューアーの一覧で次のファイルを開きます。 または、[ **保存]** を選択し、[ **ラベル付けされた例** ] ボックスの一覧から別のファイルを選択します。

3. ビューアーで手順 1 と手順 2 を繰り返し、ラベルをすべてのファイルに保存するまで繰り返します。

ファイルにラベルを付けた後、トレーニングに移行するように通知する通知バナーが表示されます。 さらに多くのドキュメントにラベルを付けるか、トレーニングに進むか選択できます。

#### <a name="add-an-explanation"></a>説明を作成する

エンティティの形式自体とサンプル ファイルに含まれる可能性のあるバリエーションに関するヒントを提供する説明を作成できます。 たとえば、日付値には、次のようなさまざまな形式を使用できます。

- 10/14/2019
- 2019 年 10 月 14 日
- 2019 年 10 月 14 日、月曜日

*契約開始日* を特定するために、パターンの説明を作成できます。

1. [説明] セクション **で** 、[ **新規** ] を選択し、[空白] を選択 **します**。

2. [ **説明を作成する** ] ページで：

    a. [ **名前]** フィールドに、説明の名前 (Date など) を入力 *します*。

    b. [ **説明の種類** ] フィールドで、[ **パターン] ボックスの一覧** を選択します。

    c. [ **値]** フィールドで、サンプル ファイルに表示される日付のバリエーションを指定します。 たとえば、0/00/0000 として表示される日付形式がある場合は、次のようなドキュメントに表示されるバリエーションを入力します。

    - 0/0/0000
    - 0/00/0000
    - 00/0/0000
    - 00/00/0000

4. **[保存してトレーニング] を選択します**。

#### <a name="test-your-model-again"></a>モデルをもう一度テストする

コントラクト モデルは、前に見たことがないサンプル ファイルでテストできます。 これは省略可能ですが、便利なベスト プラクティスになる可能性があります。

1. [ **モデル>コントラクト>コントラクト分類子** ] ページで、[ **テスト** ] タブを選択します。これにより、ラベルのないサンプル ファイルでモデルが実行されます。

2. **テスト ファイル** の一覧で、サンプル ファイルが表示され、モデルが必要な情報を抽出できるかどうかを示します。 この情報を使用して、ドキュメントを特定するときの分類子の有効性を判断します。

3. 完了したら、[ **トレーニングの終了**] を選択します。

### <a name="apply-your-model-to-a-document-library"></a>ドキュメント ライブラリにモデルを適用する

SharePoint ドキュメント ライブラリにモデルを適用するには:

1. [**モデル> コントラクト**] ページの [**Key actionsApply** >  **model to librarys**] で、[モデルの **適用**] を選択します。

   ![[モデルをライブラリに適用] オプションが強調表示されている [Contracts] ページを示すスクリーンショット。](../media/content-understanding/key-actions-apply-model.png)

2. [**コントラクトの追加]** パネルで、モデルを適用するドキュメント ライブラリを含むSharePoint サイトを選択します。 リストにサイトが表示されない場合は、検索ボックスを使用して検索します。 **[追加]** を選択します。

    > [!NOTE]
    > モデルを適用しようとしているドキュメントライブラリへの *リスト管理* 許可を持っているかまたは、*編集* 権限を持っていなければなりません。

3. サイトを選択したら、モデルを適用するドキュメント ライブラリを選択します。

4. モデルはコンテンツ タイプに関連付けられているため、ライブラリに適用すると、抽出したラベルが列として表示されたコンテンツ タイプとそのビューが追加されます。 このビューは既定ではライブラリの既定のビューですが、必要に応じて [ **詳細設定** ] を選択し、[ **この新しいビューを既定として設定** ] チェック ボックスをオフにすることで、既定のビューにすることはできません。

5. モデルをライブラリに適用するには、[ **追加** ] を選択します。

6. [**モデル > コントラクト**] ページの [**このモデルを含むライブラリ**] セクションに、SharePoint サイトの URL が一覧表示されます。

    ![このモデルセクションを含むライブラリを示すコントラクト ホーム ページのスクリーンショット。](../media/content-understanding/contract-libraries-with-this-model.png)

7. **[設定** > **Library の設定**:

   - **Status** という名前の列を追加し、列の種類として **[選択**] を選択します。
   - **In review**、**Approved**、**Rejected** の値を適用します。

モデルをドキュメント ライブラリに適用した後、サイトへのドキュメントのアップロードを開始し、結果を確認できます。

## <a name="next-step"></a>次の手順

[手順 2.Microsoft Teamsを使用してコントラクト管理チャネルを作成する](solution-manage-contracts-step2.md)