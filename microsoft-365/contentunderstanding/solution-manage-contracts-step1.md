---
title: 手順 1. 契約ファイルSharePoint Syntexデータの抽出に使用する方法
ms.author: chucked
author: chuckedmonson
manager: pamgreen
ms.reviewer: ssquires
audience: admin
ms.topic: article
ms.date: ''
ms.prod: microsoft-365-enterprise
search.appverid: ''
localization_priority: None
ROBOTS: ''
description: ソリューションを使用して、SharePoint Syntexファイルを識別し、データを抽出する方法についてMicrosoft 365します。
ms.openlocfilehash: d26a11edfbfadfa9b8905e9cb7643cfefeef9b1e1f6e7e0516c50305fe974d71
ms.sourcegitcommit: a1b66e1e80c25d14d67a9b46c79ec7245d88e045
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/05/2021
ms.locfileid: "53859527"
---
# <a name="step-1-use-sharepoint-syntex-to-identify-contract-files-and-extract-data"></a>手順 1. 契約ファイルSharePoint Syntexデータの抽出に使用する方法

組織では、受信した多数のファイルからすべての契約ドキュメントを識別して分類する方法が必要です。 また、特定された各コントラクト ファイル内のいくつかの重要な要素 (クライアント、契約者、手数料金額など)をすばやく *表示できます*。 この操作を行うには、SharePoint Syntex[を使用](index.md)してドキュメント理解モデルを作成し、それをドキュメント ライブラリに適用します。

## <a name="overview-of-the-process"></a>プロセスの概要

[ドキュメントの理解](document-understanding-overview.md) では、人工知能 (AI) モデルを使用して、ファイルの分類と情報の抽出を自動化します。 ドキュメント理解モデルは、必要な情報がテーブルやフォーム (コントラクトなど) に含まれている必要のない非構造化ドキュメントや半構造化ドキュメントから情報を抽出する場合にも最適です。 

ドキュメント理解モデルは、光学式文字認識 (OCR) テクノロジーを使用して、PDF、画像、および TIFF ファイルをスキャンします。これは、サンプル ファイルを使用してモデルをトレーニングする場合と、ドキュメント ライブラリ内のファイルに対してモデルを実行する場合の両方です。

1. 最初に、モデルを "トレーニング" して、識別しようとしているコンテンツ タイプ (契約) に固有の特性を検索するために使用できる少なくとも 5 つのサンプル ファイルを見つける必要があります。 

2. このSharePoint Syntexを使用して、新しいドキュメント理解モデルを作成します。 サンプル ファイルを使用して、分類子 [を作成する必要があります](create-a-classifier.md)。 サンプル ファイルを使用して分類子をトレーニングすると、会社の契約に表示される特性に固有の特性を検索できます。 たとえば、サービス契約、契約条件、報酬など、契約内の特定の文字列を検索する "説明 ["](create-a-classifier.md#create-an-explanation)を作成 *します*。 説明をトレーニングして、ドキュメントの特定のセクションでこれらの文字列を探したり、他の文字列の横に位置したりすることもできます。 分類子に必要な情報をトレーニングしたと思う場合は、サンプル ファイルのサンプル セットでモデルをテストして、その効率を確認できます。 テスト後、必要に応じて説明を変更して、より効率的に行えます。 

3. モデルでは、抽出プログラム [を作成して](create-an-extractor.md) 、各コントラクトから特定のデータを抽出できます。 たとえば、契約ごとに、最も懸念される情報は、クライアントが誰か、契約者の名前、および総コストです。

4. モデルを正常に作成したら、そのモデルを[ドキュメント ライブラリSharePoint適用します](apply-a-model.md)。 ドキュメントをドキュメント ライブラリにアップロードすると、ドキュメント理解モデルが実行され、モデルで定義したコントラクト コンテンツ タイプに一致するファイルすべてが識別され、分類されます。 コントラクトとして分類されたファイルはすべて、カスタム ライブラリ ビューに表示されます。 ファイルには、抽出プログラムで定義した各コントラクトの値も表示されます。

   ![ドキュメント ライブラリ内のコントラクト](../media/content-understanding/doc-lib-solution.png)

5. 契約の保持要件またはセキュリティ要件がある場合は、モデルを使用して保持ラベルまたは感度ラベルを適用[](apply-a-retention-label-to-a-model.md)して、指定した[](apply-a-sensitivity-label-to-a-model.md)期間契約が削除されるのを防ぐか、契約にアクセスできるユーザーを制限することができます。

## <a name="steps-to-create-and-train-your-model"></a>モデルを作成してトレーニングする手順

> [!NOTE]
> これらの手順では、Contracts Management Solution Assets リポジトリのサンプル [ファイルを使用できます](https://github.com/pnp/syntex-samples/tree/main/scenario%20assets/Contracts%20Management)。 このリポジトリの例には、ドキュメント理解モデル ファイルと、モデルのトレーニングに使用されるファイルの両方が含まれています。

### <a name="create-a-contract-model"></a>コントラクト モデルの作成

最初の手順は、コントラクト モデルを作成します。

1. コンテンツ センターで、**[新規]** を選択し、**[モデルを作成する]** を選択します。

2. [新しい **ドキュメントの理解モデル] ウィンドウ** の [ **名前** ] フィールドに、モデルの名前を入力します。 このコントラクト管理ソリューションでは、モデルの Contract という名前を *付けできます*。

4. **[作成]** を選択します。 これにより、モデルのホームページが作成されます。</br>

    ![契約のホーム ページのスクリーンショット。](../media/content-understanding/models-contract-home-page.png)


### <a name="train-your-model-to-classify-a-type-of-file"></a>モデルをトレーニングしてファイルの種類を分類する

#### <a name="add-example-files-for-your-model"></a>モデルのサンプル ファイルの追加

コントラクト ドキュメントである 5 つ以上のサンプル ファイルと、契約ドキュメントではない 1 つのサンプル ファイル (作業明細書など) を追加する必要があります。 

1. [モデルと **契約>] ページの [** キー アクションサンプル **ファイルの** 追加] で、[  >  ファイルの追加]**を選択します**。

   ![[サンプル ファイルの追加] オプションが強調表示された [コントラクト] ページを示すスクリーンショット。](../media/content-understanding/key-actions-add-example-files.png)

2. [モデルの **サンプル ファイルの選択]** ページで、Contract フォルダーを開き、使用するファイルを選択し、[追加] を **選択します**。 そこにサンプル ファイルが含めなかった場合は、[**ファイルのアップロード** 選択して追加します。

#### <a name="label-the-files-as-positive-or-negative-examples"></a>ファイルに正または負のラベルを付ける

1. [契約の **モデル>] ページの [キー** アクション ファイルの分類とトレーニングの実行] で、[トレーニング分類子  >  **] を選択します**。

   ![[ファイルの分類とトレーニングの実行] オプションが強調表示された [契約] ページを示すスクリーンショット。](../media/content-understanding/key-actions-classify-files.png)

2. [Model **> Contract > Contract classifier]** ページの最初のサンプル ファイルの上部にあるビューアーに、作成したコントラクト モデルの例を示すテキストが表示されます。 この例がポジティブの場合は、[ **はい**] を選択します。 ネガティブの例の場合は、[ **いいえ**] を選択します。

3. 左側の **[ラベル付き例]** リストから、例として使用する他のファイルを選択し、ラベルを付ける。 

    ![分類子ホームページ](../media/content-understanding/models-contract-classifier.png) 

#### <a name="add-at-least-one-explanation-to-train-the-classifier"></a>分類子をトレーニングするために少なくとも 1 つの説明を追加する 

1. [契約 **分類子>モデル>]** ページで、[Train] タブ **を選択** します。

2. [トレーニング **済みファイル]** セクションには、以前にラベル付けしたサンプル ファイルの一覧が表示されます。 一覧から正のファイルのいずれかを選択して、ビューアーに表示します。

3. [説明 **] セクションで、[** 新規] を選択 **し、[空白** ] を **選択します**。

4. [ **説明を作成する** ] ページで：

    a. [名前 **] フィールド** に、説明の名前 ("Agreement" など) を入力します。

    b. [説明 **の種類]** フィールドで、[語句の一 **覧**] を選択します。テキスト文字列を追加します。

    c. [語句 **] リスト ボックス** に、文字列 ("AGREEMENT" など) を入力します。 文字列で大文字 **と小文字を** 区別する必要がある場合は、[大文字と小文字を区別する] を選択できます。

    d. [保存 **してトレーニング] を選択します**。

    ![[説明の作成] パネルのスクリーンショット。](../media/content-understanding/contract-classifier-create-explanation.png) 

#### <a name="test-your-model"></a>モデルをテストする

コントラクト モデルは、前に見たことがないサンプル ファイルでテストできます。 これはオプションですが、便利なベスト プラクティスになる場合があります。

1. [契約 **分類子>モデル>] ページで** 、[テスト] タブ **を選択** します。これにより、ラベルが付いていないサンプル ファイルでモデルが実行されます。

2. [テスト **ファイル] ボックスの** 一覧で、サンプル ファイルが表示され、モデルで正または負の値が予測された場合に表示されます。 この情報を使用して、ドキュメントを特定するときの分類子の有効性を判断します。

    ![[テキスト ファイル] リストのラベル付けされていないファイルのスクリーンショット](../media/content-understanding/test-on-files.png) 

3. 完了したら、[トレーニングの終了 **] を選択します**。

### <a name="create-and-train-an-extractor"></a>抽出プログラムの作成とトレーニング

1. [契約の **モデル>] ページの** [キー アクション抽出プログラムの作成とトレーニング] で、[抽出  >  プログラムの作成 **] を選択します**。

   ![[抽出プログラムの作成とトレーニング] オプションが強調表示された [契約] ページを示すスクリーンショット。](../media/content-understanding/key-actions-create-extractors.png)

2. [新しい **エンティティ抽出プログラム] パネル** の [ **新しい名前** ] フィールドに、抽出プログラムの名前を入力します。 たとえば、各コントラクトから *クライアントの* 名前を抽出する場合は、[クライアント] という名前を付します。

3. 完了したら、[作成] を **選択します**。

#### <a name="label-the-entity-you-want-to-extract"></a>抽出するエンティティにラベルを付け

抽出プログラムを作成すると、抽出ページが開きます。 ここでは、サンプルファイルの一覧が表示されます。リストの最初のファイルは、viewer に表示されています。

![[クライアント抽出プログラム] [ラベル付き例] ページのスクリーンショット。](../media/content-understanding/client-extractor-labeled-examples.png) 

エンティティにラベルを付けするには、次の方法を実行します。

1. Viewer で、ファイルから抽出するデータを選択します。 たとえば、クライアントを抽出する場合は、最初のファイル (この例では Best *For You Organics)* でクライアント値を強調表示し、[保存] を選択 **します**。 [ラベル付き例] ボックスの一覧の [ **ラベル** ] 列に、ファイルの値が **表示** されます。

2. [ **次のファイル]** を選択して自動保存し、ビューアーの一覧で次のファイルを開きます。 または、[ **保存] を** 選択し、[ラベル付き例] リストから別 **のファイルを選択** します。

3. ビューアーで、手順 1 と 2 を繰り返し、すべてのファイルにラベルを保存するまで繰り返します。

ファイルのラベルが付いた後、トレーニングに移動する通知バナーが表示されます。 より多くのドキュメントにラベルを付け、トレーニングに進むか選択できます。

#### <a name="add-an-explanation"></a>説明を作成する

エンティティ形式自体と、サンプル ファイルに含め得るバリエーションに関するヒントを提供する説明を作成できます。 たとえば、日付の値は、次のようなさまざまな形式で指定できます。

- 10/14/2019
- 2019 年 10 月 14 日
- 2019 年 10 月 14 日、月曜日

契約開始日を *特定するために*、パターンの説明を作成できます。

1. [説明 **] セクションで、[** 新規] を選択 **し、[空白** ] を **選択します**。

2. [ **説明を作成する** ] ページで：

    a. [名前 **] フィールド** に、説明の名前 (Date など) を入力 *します*。

    b. [説明の **種類] フィールドで** 、[パターン一覧] **を選択します**。

    c. [値 **] フィールド** に、サンプル ファイルに表示される日付バリエーションを指定します。 たとえば、0/00/0000 として表示される日付形式がある場合は、次のようなドキュメントに表示されるバリエーションを入力します。

    - 0/0/0000
    - 0/00/0000
    - 00/0/0000
    - 00/00/0000

4. [保存 **してトレーニング] を選択します**。

#### <a name="test-your-model-again"></a>モデルを再度テストする

コントラクト モデルは、前に見たことがないサンプル ファイルでテストできます。 これはオプションですが、便利なベスト プラクティスになる場合があります。

1. [契約 **分類子>モデル>] ページで** 、[テスト] タブ **を選択** します。これにより、ラベルが付いていないサンプル ファイルでモデルが実行されます。

2. テスト ファイル **の一覧** で、サンプル ファイルが表示され、モデルが必要な情報を抽出できる場合に表示されます。 この情報を使用して、ドキュメントを特定するときの分類子の有効性を判断します。

3. 完了したら、[トレーニングの終了 **] を選択します**。

### <a name="apply-your-model-to-a-document-library"></a>ドキュメント ライブラリにモデルを適用する

モデルをドキュメント ライブラリにSharePointするには、次のSharePoint使用します。

1. [モデルと **契約>] ページの [** キー アクション] の [モデルをライブラリに適用する] で、[  >  モデルの適用]**を選択します**。

   ![[ライブラリにモデルを適用する] オプションが強調表示された [コントラクト] ページを示すスクリーンショット。](../media/content-understanding/key-actions-apply-model.png)

2. [契約 **の追加]** パネルで、モデルSharePointするドキュメント ライブラリを含むサイトを選択します。 リストにサイトが表示されない場合は、検索ボックスを使用して検索します。 **[追加]** を選択します。

    > [!NOTE]
    > モデルを適用しようとしているドキュメントライブラリへの *リスト管理* 許可を持っているかまたは、*編集* 権限を持っていなければなりません。

3. サイトを選択した後、モデルを適用するドキュメント ライブラリを選択します。

4. モデルはコンテンツ タイプに関連付けられているため、ライブラリに適用すると、抽出したラベルが列として表示されたコンテンツ タイプとそのビューが追加されます。 このビューは、既定ではライブラリの既定のビューですが、[詳細設定] を選択し、[この新しいビューを既定として設定する] チェック ボックスをオフにすることで、既定のビューにしないオプション **を選択できます**。

5. モデルをライブラリに適用するには、[ **追加** ] を選択します。

6. [モデル **>契約**] ページの [このモデルを含むライブラリ] セクションに、一覧に表示されるサイトの URL SharePoint表示されます。

    ![[このモデルを使用したライブラリ] セクションを示すコントラクト ホーム ページのスクリーンショット。](../media/content-understanding/contract-libraries-with-this-model.png)

7. [ライブラリ **設定**  >  **設定] の下:**

   - Status という名前の列 **を追加し** 、列 **の種類として [選択肢** ] を選択します。
   - [確認中 **] 、[承認済****み] 、および**[拒否済み]**の値を適用** します。

モデルをドキュメント ライブラリに適用した後、サイトへのドキュメントのアップロードを開始し、結果を確認できます。

## <a name="next-step"></a>次の手順

[手順 2.契約Microsoft Teamsチャネルを作成するには、次の情報を使用します。](solution-manage-contracts-step2.md)