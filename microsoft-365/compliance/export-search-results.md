---
title: コンテンツの検索結果をエクスポートする
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: how-to
f1_keywords:
- ms.o365.cc.CustomizeExport
ms.service: O365-seccomp
ms.localizationpriority: medium
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- SPO_Content
search.appverid:
- MOE150
- MED150
- MET150
ms.assetid: ed48d448-3714-4c42-85f5-10f75f6a4278
description: Microsoft Purview コンプライアンス ポータルのコンテンツ検索からローカル コンピューターに検索結果をエクスポートします。 電子メールの結果は PST ファイルとしてエクスポートされます。 SharePoint サイトとOneDrive for Business サイトのコンテンツは、ネイティブ Office ドキュメントとしてエクスポートされます。
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 38faaf29087e67aef161e46a1fbc6c338d9c33e4
ms.sourcegitcommit: caedcf7f16eed23596487d97c375d4bc4c8f3566
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/20/2022
ms.locfileid: "64995472"
---
# <a name="export-content-search-results"></a>コンテンツの検索結果をエクスポートする

[!include[Purview banner](../includes/purview-rebrand-banner.md)]

コンテンツ検索が正常に実行されたら、検索結果をローカル コンピューターにエクスポートできます。 電子メールの結果をエクスポートする場合は、PST ファイルとしてコンピューターにダウンロードされます。 SharePoint サイトとOneDrive for Business サイトからコンテンツをエクスポートすると、ネイティブ Office ドキュメントのコピーがエクスポートされます。 エクスポートされた検索結果には、他のドキュメントとレポートが含まれています。
  
コンテンツ検索の結果をエクスポートするには、結果を準備してからローカル コンピューターにダウンロードする必要があります。 検索結果をエクスポートするためのこれらの手順は、Microsoft Purview 電子情報開示 (Standard) ケースに関連付けられている検索の結果をエクスポートする場合にも適用されます。
  
## <a name="before-you-export-search-results"></a>検索結果をエクスポートする前に

- 検索結果をエクスポートするには、Microsoft Purview コンプライアンス ポータルでエクスポート管理ロールを割り当てる必要があります。 この役割は、組み込みの電子情報開示マネージャーの役割グループに割り当てられます。 既定では、Organization Management 役割グループには割り当てられません。 詳細については、「[電子情報開示のアクセス許可を割り当てる](assign-ediscovery-permissions.md)」を参照してください。電子情報開示のアクセス許可を割り当てる」を参照してください。

- 検索結果をエクスポートする際に使用するコンピューターは、次のシステム要件を満たす必要があります。
  
  - Windowsの最新バージョン (32 ビットまたは 64 ビット)
  
  - Microsoft .NET Framework 4.7 以降
  
- 電子情報開示エクスポート ツールを実行するには、Microsoft Edge <sup>1</sup> を使用する必要があります。 Internet Explorer 11 を使用して検索結果をエクスポートすることはサポートされなくなりました<sup>2</sup>。
  
  > [!NOTE]
  > <sup>1</sup> Microsoft Edgeに対する最近の変更の結果、ClickOnceサポートは既定で有効にされなくなりました。 Edge でClickOnceサポートを有効にする手順については、「[Microsoft Edgeで電子情報開示エクスポート ツールを使用](configure-edge-to-export-search-results.md)する」を参照してください。 また、Microsoft は、ClickOnce アプリケーション用のサード パーティ製の拡張機能やアドオンを製造していません。 サポートされていないブラウザーとサードパーティの拡張機能またはアドオンを使用した検索結果のエクスポートはサポートされていません。
  >
  > <sup>2</sup> 2021 年 8 月以降、Microsoft 365 アプリとサービスは Internet Explorer 11 (IE11) をサポートしなくなり、ユーザーのエクスペリエンスが低下したり、それらのアプリやサービスに接続できない場合があります。 これらのアプリとサービスは、今後数週間と数か月にわたって段階的に廃止され、サポートがスムーズに終了します。 各アプリとサービスは、独立したスケジュールで段階的に廃止されています。 詳細については、この [ブログ投稿](https://techcommunity.microsoft.com/t5/microsoft-365-blog/microsoft-365-apps-say-farewell-to-internet-explorer-11-and/ba-p/1591666)を参照してください。

- 手順 2. で検索結果をダウンロードする電子情報開示エクスポート ツールでは、自動化はサポートされていません (スクリプトを使用するか、コマンドレットを実行します)。 手順 1 の準備プロセスや手順 2 のダウンロード プロセスを自動化しないことを強くお勧めします。 これらのプロセスのいずれかを自動化した場合、問題が発生した場合、Microsoft サポートはサポートを提供しません。

- ローカル コンピューターに検索結果をダウンロードすることをお勧めします。 検索結果のダウンロード時に会社のファイアウォールまたはプロキシ インフラストラクチャで問題が発生しないようにするには、ネットワークの外部にある仮想デスクトップに検索結果をダウンロードすることを検討してください。 これにより、多数のファイルをエクスポートするときに Azure データ接続で発生するタイムアウトが減少する可能性があります。 仮想デスクトップの詳細については、「[仮想デスクトップのWindows](https://azure.microsoft.com/services/virtual-desktop)」を参照してください。

- 検索結果をダウンロードするときのパフォーマンスを向上させるには、大きな結果セットを返す検索を小さな検索に分割することを検討してください。 たとえば、検索クエリで日付範囲を使用すると、より短い結果セットを返すことができます。このセットは、より速くダウンロードできます。
  
- 検索結果をエクスポートすると、ローカル コンピューターにダウンロードされる前に、データは Microsoft クラウド内の Microsoft 提供のAzure Storageの場所に一時的に保存されます。 組織が Azure のエンドポイント (.blob.core.windows.net) に接続できることを確認します (ワイルドカードは **\*** エクスポートの一意の識別子を表します)。 検索結果データは、作成から 2 週間後にAzure Storage場所から削除されます。 
  
- 組織がプロキシ サーバーを使用してインターネットと通信する場合は、検索結果のエクスポートに使用するコンピューターでプロキシ サーバー設定を定義する必要があります (そのため、エクスポート ツールはプロキシ サーバーによって認証されます)。 これを行うには、*Windows* のバージョンと一致する場所にあるmachine.configファイルを開きます。 
  
  - **32 ビット:** `%windir%\Microsoft.NET\Framework\[version]\Config\machine.config`
  
  - **64 ビット:** `%windir%\Microsoft.NET\Framework64\[version]\Config\machine.config`
  
    machine.config *ファイルと* タグの間のどこかに次の行を`<configuration>``</configuration>`追加します。 組織の正しい値に必ず置き換えてください`ProxyServer``Port`。たとえば、 `proxy01.contoso.com:80` 
  
    ```xml
    <system.net>
       <defaultProxy enabled="true" useDefaultCredentials="true">
         <proxy proxyaddress="https://ProxyServer :Port " 
                usesystemdefault="False" 
                bypassonlocal="True" 
                autoDetect="False" />
       </defaultProxy>
    </system.net>
    ```

- 検索の結果が 7 日を超えてエクスポート ジョブを送信した場合は、検索結果を更新するために検索を再実行するように求めるエラー メッセージが表示されます。 このような場合は、エクスポートを取り消し、検索を再実行してから、エクスポートを再度開始します。

## <a name="step-1-prepare-search-results-for-export"></a>手順 1: エクスポートする検索結果を準備する

最初の手順では、エクスポートする検索結果を準備します。 結果を準備すると、Microsoft クラウド内の Microsoft 提供のAzure Storage場所にアップロードされます。 メールボックスとサイトのコンテンツは、1 時間あたり最大 2 GB のレートでアップロードされます。
  
1. コンプライアンス ポータルで、結果をエクスポートするコンテンツ検索を選択します。
  
2. ポップアップ ページの下部にある **[アクション]** メニューで、[ **結果のエクスポート**] をクリックします。

   ![[アクション] メニューの [結果のエクスポート] オプション。](../media/ActionMenuExportResults.png)

   [ **結果のエクスポート]** ポップアップ ページが表示されます。 コンテンツをエクスポートするために使用できるエクスポート オプションは、検索結果がメールボックスまたはサイト内にあるか、またはその両方の組み合わせにあるかによって異なります。

3. [ **出力オプション]** で、次のいずれかのオプションを選択します。
  
   ![出力オプションをエクスポートします。](../media/ExportOutputOptions.png)

    - **認識されない形式を持つアイテムを除くすべてのアイテムが暗号化されているか、他の理由でインデックスが作成されていません**。 このオプションでは、インデックス付きアイテムのみがエクスポートされます。
  
    - **認識されない形式を持つアイテムを含むすべてのアイテムが暗号化されているか、他の理由でインデックスが作成されませんでした**。 このオプションは、インデックス付きアイテムとインデックスなしアイテムをエクスポートします。
  
    - 認識 **できない形式を持つアイテム、暗号化されている項目、または他の理由でインデックスが作成されなかった項目のみです**。 このオプションでは、インデックスが設定されていないアイテムのみがエクスポートされます。

      部分的にインデックスが付けられたアイテムのエクスポート方法については、「 [詳細情報](#more-information) 」セクションを参照してください。 部分的にインデックスが付けられたアイテムの詳細については、 [コンテンツ検索の部分インデックス付きアイテムに](partially-indexed-items-in-content-search.md)関するページを参照してください。

4. [**Exchange コンテンツをエクスポートする**] で、次のいずれかのオプションを選択します。
  
   ![Exchangeオプション。](../media/ExchangeExportOptions.png)

    - **メールボックスごとに 1 つの PST ファイル**: 検索結果を含むユーザー メールボックスごとに 1 つの PST ファイルをエクスポートします。 ユーザーのアーカイブ メールボックスの結果はすべて、同じ PST ファイルに含まれます。 このオプションは、ソース メールボックスからメールボックス フォルダー構造を再現します。
  
    - **すべてのメッセージを含む 1 つの PST ファイル**: 検索に含まれるすべてのソース メールボックスの検索結果を含む 1 つの PST ファイル (*Exchange.pst* という名前) をエクスポートします。 このオプションは、各メッセージのメールボックス フォルダー構造を再現します。
  
    - **1 つのフォルダー内のすべてのメッセージを含む 1 つの PST ファイル**: すべてのメッセージが 1 つの最上位フォルダーにある 1 つの PST ファイルに検索結果をエクスポートします。 このオプションを使用すると、レビュー担当者は、アイテムごとに元のメールボックス フォルダー構造を移動することなく、アイテムを時系列順に確認できます (アイテムは送信日別に並べ替えられます)。
  
    - **個々のメッセージ**: .msg 形式を使用して、検索結果を個々の電子メール メッセージとしてエクスポートします。 このオプションを選択すると、ファイル システム内のフォルダーに電子メール検索結果がエクスポートされます。 個々のメッセージのフォルダー パスは、結果を PST ファイルにエクスポートした場合に使用されたものと同じです。
  
5. 次の追加オプションを構成します。

   ![その他のエクスポート オプションを構成します。](../media/OtherExportOptions.png)

   1. 重複するメッセージを除外するには、[**Exchange コンテンツの重複除去を有効にする**] チェック ボックスをオンにします。
  
      このオプションを選択すると、検索されたメールボックスに同じメッセージのコピーが複数見つかった場合でも、メッセージのコピーは 1 つだけエクスポートされます。 エクスポート結果レポート (Results.csv という名前のファイル) には、重複するメッセージのコピーごとに行が含まれるため、重複するメッセージのコピーを含むメールボックス (またはパブリック フォルダー) を識別できます。 重複除去と重複アイテムの識別方法の詳細については、 [電子情報開示検索結果の重複除去に](de-duplication-in-ediscovery-search-results.md)関するページを参照してください。
  
   2. [**SharePoint ファイルのバージョンを含める**] チェック ボックスをオンにすると、SharePointドキュメントのすべてのバージョンがエクスポートされます。 このオプションは、検索のコンテンツ ソースにSharePointサイトまたはOneDrive for Business サイトが含まれている場合にのみ表示されます。
  
   3. **圧縮された (zip 形式の) フォルダー内のファイルをエクスポートするを選択します。検索結果を圧縮フォルダーにエクスポートする個々のメッセージとSharePointドキュメントのチェック ボックスのみが含まれます**。 このオプションは、個々のメッセージとしてExchangeアイテムをエクスポートすることを選択した場合と、検索結果にSharePointまたはOneDriveドキュメントが含まれている場合にのみ表示されます。 このオプションは、主に、項目のエクスポート時にファイル パス名Windows 260 文字の制限を回避するために使用されます。 詳細については、「エクスポートされたアイテムのファイル名」を [参照](#more-information) してください。
   > [!IMPORTANT]
   > 圧縮 (zip) フォルダー内のファイルをエクスポートすると、エクスポート時間が長くなります。
  
6. **[エクスポート]** をクリックして、エクスポート プロセスを開始します。 検索結果はダウンロード用に準備されています。つまり、元のコンテンツの場所から収集され、Microsoft クラウド内のAzure Storageの場所にアップロードされます。 この処理には数分間かかる場合があります。

エクスポートされた検索結果をダウンロードする手順については、次のセクションを参照してください。
  
## <a name="step-2-download-the-search-results"></a>手順 2:検索結果をダウンロードする

次の手順では、Azure Storageの場所からローカル コンピューターに検索結果をダウンロードします。

> [!NOTE]
> エクスポートされた検索結果は、手順 1 でエクスポート ジョブを作成してから 14 日以内にダウンロードする必要があります。
  
1. コンプライアンス ポータルの **[コンテンツ検索** ] ページで、[ **エクスポート** ] タブを選択します。
  
   エクスポート ジョブの一 **覧を更新** して、作成したエクスポート ジョブが表示されるように更新する必要がある場合があります。 エクスポート ジョブの名前は、対応する検索と同じ名前で、 **_Export** 検索名に追加されます。
  
2. 手順 1. で作成したエクスポート ジョブを選択します。

3. **[エクスポート] キー** の下にあるポップアップ ページで、[**クリップボードにコピー**] をクリックします。 手順 6 でこのキーを使用して、検索結果をダウンロードします。
  
   > [!IMPORTANT]
   > 電子情報開示エクスポート ツールをインストールして開始し、このキーを使用して検索結果をダウンロードすることはだれにでもできるため、このキーは、パスワードやその他のセキュリティ関連の情報を保護する場合と同様の予防策を講じてください。 

4. ポップアップ ページの上部にある [ **結果のダウンロード**] をクリックします。

5. **電子情報開示エクスポート ツール** のインストールを求めるメッセージが表示されたら、[**インストール**] をクリックします。

6. **電子情報開示エクスポート ツール** で、次の操作を行います。

   ![電子情報開示エクスポート ツール。](../media/eDiscoveryExportTool.png)

   1. 手順 3 でコピーしたエクスポート キーを適切なボックスに貼り付けます。
  
   2. **[参照]** をクリックして、検索結果のファイルをダウンロードする場所を指定します。
  
      > [!IMPORTANT]
      >  ダウンロード中のネットワーク アクティビティが高いため、ローカル コンピューター上の内部ドライブ上の場所にのみ検索結果をダウンロードする必要があります。 最適なダウンロード エクスペリエンスを得るには、次のガイドラインに従ってください。 <br/>
      >- UNC パス、マップされたネットワーク ドライブ、外部 USB ドライブ、同期されたOneDrive for Business アカウントに検索結果をダウンロードしないでください。<br/>
      >- 検索結果をダウンロードするフォルダーのウイルス対策スキャンを無効にします。<br/>
      >- 同時ダウンロード ジョブ用に検索結果を別のフォルダーにダウンロードします。

7. **[開始]** をクリックして、検索結果をコンピューターにダウンロードします。
  
    **電子情報開示エクスポート ツール** には、ダウンロードする残りのアイテムの数とサイズの見積もりなど、エクスポート プロセスの状態に関する情報が表示されます。 エクスポート処理が完了したら、ダウンロードした場所のファイルにアクセスできます。

## <a name="more-information"></a>詳細情報

検索結果のエクスポートの詳細については、次をご覧ください。
  
[エクスポートの制限](#export-limits)
  
[レポートをエクスポートする](#export-reports)
  
[部分的にインデックスが作成されたアイテムのエクスポート](#exporting-partially-indexed-items)

[個々のメッセージまたは PST ファイルをエクスポートする](#exporting-individual-messages-or-pst-files)

[RMS で保護された電子メール メッセージと暗号化された添付ファイルの暗号化解除](#decrypting-rms-protected-email-messages-and-encrypted-file-attachments)

[エクスポートされたアイテムのファイル名](#filenames-of-exported-items)  
  
[その他](#miscellaneous)
  
### <a name="export-limits"></a>エクスポートの制限

コンテンツ検索結果をエクスポートするときの制限については、「コンテンツ検索の制限」の「エクスポートの制限」セクション [を](limits-for-content-search.md#export-limits)参照してください。

### <a name="export-reports"></a>レポートをエクスポートする
  
- 検索結果をエクスポートすると、検索結果に加えて次のレポートが含まれます。
  
  - **エクスポートの概要** エクスポートの概要を含むExcelドキュメント。 これには、検索されたコンテンツ ソースの数、検索結果の推定サイズとダウンロードサイズ、エクスポートされたアイテムの推定数とダウンロード数などの情報が含まれます。
  
  - **マニフェスト** 検索結果に含まれる各項目に関する情報を含むマニフェスト ファイル (XML 形式)。
  
  - **結果** 検索結果としてダウンロードされる各項目に関する情報を含むExcelドキュメント。 電子メールの場合、結果ログには、次のような各メッセージに関する情報が含まれます。
  
    - 移行元のメールボックス内のメッセージの場所 (メッセージがプライマリ メールボックスとアーカイブ メールボックスのどちらであるかを含みます)。
  
    - メッセージが送信または受信された日付。

    - メッセージの件名行。

    - メッセージの送信者と受信者。

    - 検索結果をエクスポートするときに重複除去オプションを有効にした場合、メッセージが重複メッセージであるかどうか。 重複するメッセージの値は、[ **アイテムに複製] 列に** 含まれ、メッセージは重複として識別されます。 [ **アイテムに複製]** 列の値には、エクスポートされたメッセージのアイテム ID が含まれます。 詳細については、「 [電子情報開示検索結果の重複除去](de-duplication-in-ediscovery-search-results.md)」を参照してください。

      SharePointサイトおよびOneDrive for Business サイトのドキュメントの場合、結果ログには、次のような各ドキュメントに関する情報が含まれます。

      - ドキュメントの URL。

      - ドキュメントがあるサイト コレクションの URL。

      - ドキュメントが最後に変更された日付。

      - ドキュメントの名前 (これは、結果のログの [件名] 列にあります)。

  - **インデックスが設定されていないアイテム** 検索結果に含まれる部分的にインデックスが付けられたアイテムに関する情報を含むExcel ドキュメント。 検索結果レポートを生成するときに部分的にインデックスが付けられたアイテムを含めない場合、このレポートは引き続きダウンロードされますが、空になります。

  - **エラーと警告** エクスポート中に発生したファイルのエラーと警告が含まれます。 個々のエラーまたは警告に固有の情報については、エラーの詳細列を参照してください。

  - **スキップされたアイテム** SharePointサイトとOneDrive for Business サイトから検索結果をエクスポートする場合、通常、エクスポートにはスキップされたアイテム レポート (SkippedItems.csv) が含まれます。 このレポートで引用されている項目は、通常、フォルダーやドキュメント セットなど、ダウンロードされないアイテムです。 これらの種類のアイテムをエクスポートしないのは、設計上です。 スキップされた他のアイテムの場合、スキップされたアイテム レポートの [エラーの種類] フィールドと [エラーの詳細] フィールドには、アイテムがスキップされ、他の検索結果と共にダウンロードされなかった理由が表示されます。

  - **Trace.log** には、エクスポート プロセスに関する詳細なログ情報が含まれており、エクスポート中に問題を明らかにするのに役立ちます。 検索結果のエクスポートに関連する問題に関するMicrosoft サポートを含むチケットを開くと、このトレース ログの提供を求められる場合があります。
  
    > [!NOTE]
    > これらのドキュメントは、実際の検索結果をエクスポートしなくてもエクスポートできます。 [「コンテンツ検索レポートをエクスポートする](export-a-content-search-report.md)」を参照してください。
  
### <a name="exporting-partially-indexed-items"></a>部分的にインデックスの作成されたアイテムを調査する
  
- 検索結果内のすべてのメールボックス アイテムを返すコンテンツ検索からメールボックス アイテムをエクスポートする場合 (検索クエリに含まれるキーワードがないため)、インデックスのないアイテムを含む PST ファイルに部分的にインデックスが付けられたアイテムはコピーされません。 これは、部分的にインデックスが付けられたアイテムを含むすべてのアイテムが、通常の検索結果に自動的に含まれるためです。 つまり、部分的にインデックスが付けられたアイテムは、他のインデックス付きアイテムを含む PST ファイル (または個々のメッセージ) に含まれます。

    インデックス付きアイテムと部分的にインデックス付きアイテムの両方をエクスポートする場合、またはすべてのアイテムを返すコンテンツ検索からインデックス付きアイテムのみをエクスポートする場合は、同じ数のアイテムがダウンロードされます。 これは、コンテンツ検索の推定検索結果 (コンプライアンス ポータルの検索統計に表示) に、部分的にインデックスが付けられたアイテムの数に対する個別の見積もりがまだ含まれている場合でも発生します。 たとえば、すべてのアイテムを含む検索の見積もり (検索クエリのキーワードなし) は、1,000 個のアイテムが見つかり、部分的にインデックスが付けられた 200 個のアイテムも見つかったことを示しているとします。 この場合、検索ですべての項目が返されるため、1,000 個のアイテムに部分的にインデックスが付けられたアイテムが含まれます。 つまり、検索によって返されるアイテムの総数は 1,000 個であり、(予想どおり) 1,200 個のアイテムではありません。 この検索の結果をエクスポートし、インデックス付きアイテムと部分的にインデックス付きアイテムをエクスポートする (または部分的にインデックスが付けられたアイテムのみをエクスポートする) 場合、1,000 個のアイテムがダウンロードされます。 繰り返しますが、これは、空白の検索クエリを使用してすべてのアイテムを返すときに、部分的にインデックスが付けられたアイテムが通常の (インデックス付き) 結果に含まれるためです。 この同じ例では、部分的にインデックスが付けられたアイテムのみをエクスポートする場合は、インデックスが設定されていない 200 個のアイテムのみがダウンロードされます。

    また、前の例 (インデックス付きアイテムと部分的にインデックス付きアイテムをエクスポートする場合、またはインデックス付きアイテムのみをエクスポートする場合) では、エクスポートされた検索結果に含まれる **エクスポートサマリー** レポートには、前に説明したのと同じ理由で、1,000 アイテムの推定アイテムと 1,000 個のダウンロード済みアイテムが一覧表示されることにも注意してください。 

- 結果をエクスポートする検索が、特定のコンテンツの場所または組織内のすべてのコンテンツの場所を検索した場合、検索条件に一致するアイテムを含むコンテンツの場所からの部分アイテムのみがエクスポートされます。 つまり、メールボックスまたはサイトに検索結果が見つからない場合、そのメールボックスまたはサイト内の部分的にインデックスが付けられたアイテムはエクスポートされません。 その理由は、組織内の多数の場所から部分的にインデックスが作成されたアイテムをエクスポートすると、エクスポート エラーの可能性が高まり、検索結果のエクスポートとダウンロードにかかる時間が長くなる可能性があるためです。

    検索のすべてのコンテンツの場所から部分的にインデックスが付けられたアイテムをエクスポートするには、(検索クエリからキーワードを削除して) すべてのアイテムを返すように検索を構成し、検索結果をエクスポートするときに部分的にインデックスが付けられたアイテムのみをエクスポートします。

    ![3 番目のエクスポート オプションを使用して、インデックスのないアイテムのみをエクスポートします。](../media/5d7be338-a0e5-425f-8ba5-92769c24bf75.png)
  
- SharePointサイトまたはOneDrive for Business サイトから検索結果をエクスポートする場合、インデックスのないアイテムをエクスポートする機能は、選択したエクスポート オプションと、検索されたサイトに検索条件に一致するインデックス付きアイテムが含まれているかどうかによっても異なります。 たとえば、特定のSharePointサイトまたはOneDrive for Business サイトを検索し、検索結果が見つからない場合、インデックス付きアイテムとインデックスなしアイテムの両方をエクスポートする 2 番目のエクスポート オプションを選択した場合、それらのサイトのインデックスのないアイテムはエクスポートされません。 サイトのインデックス付きアイテムが検索条件と一致する場合、インデックス付きアイテムとインデックスなしアイテムの両方をエクスポートすると、そのサイトからインデックスが設定されていないすべてのアイテムがエクスポートされます。 次の図では、検索条件に一致するインデックス付きアイテムがサイトに含まれているかどうかに基づいて、エクスポート オプションについて説明します。

    ![サイトに検索条件に一致するインデックス付きアイテムが含まれているかどうかに基づいて、エクスポート オプションを選択します。](../media/94f78786-c6bb-42fb-96b3-7ea3998bcd39.png)

    a.  検索条件に一致するインデックス付きアイテムのみがエクスポートされます。 部分的にインデックスが付けられたアイテムはエクスポートされません。

    b. サイトのインデックス付きアイテムが検索条件と一致しない場合、その同じサイトから部分的にインデックスが作成されたアイテムはエクスポートされません。 サイトのインデックス付きアイテムが検索結果に返された場合、そのサイトから部分的にインデックスが作成されたアイテムがエクスポートされます。 つまり、検索条件に一致するアイテムを含むサイトから部分的にインデックスが作成されたアイテムのみがエクスポートされます。

    c. 検索条件に一致するアイテムがサイトに含まれているかどうかに関係なく、検索内のすべてのサイトから部分的にインデックスが作成されたすべてのアイテムがエクスポートされます。

    部分的にインデックスが付けられたアイテムをエクスポートすることを選択した場合、[コンテンツのエクスポート] で選択したオプションに関係なく、部分的にインデックスが付けられたメールボックス アイテムは別の PST ファイル **にエクスポートExchange**。

- 部分的にインデックスが付けられたアイテムが検索結果に返される場合 (部分的にインデックスが付けられたアイテムの他のプロパティが検索条件と一致するため)、それらの部分インデックスが通常の検索結果と共にエクスポートされます。 そのため、インデックス付きアイテムと部分的にインデックス付きアイテムの両方をエクスポートする場合 (認識 **されない形式のアイテムを含む、暗号化されているか、他の理由でインデックスが作成されていないアイテムを含む** ) オプションを選択すると、通常の結果と共にエクスポートされた部分的にインデックス付きのアイテムがResults.csv レポートに一覧表示されます。 インデックスが設定されていないitems.csv レポートには表示されません。
  
### <a name="exporting-individual-messages-or-pst-files"></a>個々のメッセージまたは PST ファイルをエクスポートする
  
- メッセージのファイル パス名がWindowsの最大文字数制限を超えた場合、ファイル パス名は切り捨てられます。 ただし、元のファイル パス名はマニフェストと ResultsLog に一覧表示されます。
  
- 前述のように、電子メール検索結果はファイル システム内のフォルダーにエクスポートされます。 個々のメッセージのフォルダー パスは、ユーザーのメールボックス内のフォルダー パスをレプリケートします。 たとえば、ユーザーの受信トレイ内の "ContosoCase101" という名前の検索では、フォルダー パス  `~ContosoCase101\\<date of export\Exchange\user@contoso.com (Primary)\Top of Information Store\Inbox`に配置されます。

- 1 つのフォルダー内のすべてのメッセージを含む 1 つの PST ファイルに電子メール メッセージをエクスポートすることを選択した場合、 **削除済みアイテム** フォルダーと **検索フォルダー** が PST フォルダーの最上位レベルに含まれます。 これらのフォルダーは空です。

- 前述のように、RMS で保護されたメッセージをエクスポートするときに暗号化を解除するには、電子メール検索結果を個々のメッセージとしてエクスポートする必要があります。 電子メール検索結果を PST ファイルとしてエクスポートした場合、暗号化されたメッセージは暗号化されたままになります。
  
### <a name="decrypting-rms-protected-email-messages-and-encrypted-file-attachments"></a>RMS で保護された電子メール メッセージと暗号化された添付ファイルの暗号化解除

コンテンツ検索の結果に含まれる権限で保護された (RMS で保護された) 電子メール メッセージは、エクスポートすると暗号化が解除されます。 さらに、 [Microsoft 暗号化テクノロジ](encryption.md) で暗号化され、検索結果に含まれる電子メール メッセージに添付されているファイルも、エクスポート時に暗号化解除されます。 この復号化機能は、電子情報開示マネージャー役割グループのメンバーに対して既定で有効になっています。 これは、RMS 復号化管理ロールが既定でこの役割グループに割り当てられているためです。 暗号化された電子メール メッセージと添付ファイルをエクスポートする場合は、次の点に注意してください。
  
- 前述のように、RMS で保護されたメッセージをエクスポートするときに復号化するには、検索結果を個々のメッセージとしてエクスポートする必要があります。 検索結果を PST ファイルにエクスポートすると、RMS で保護されたメッセージは暗号化されたままになります。

- 復号化されたメッセージは、 **ResultsLog** レポートで識別されます。 このレポートには **デコード状態** という名前の列が含まれており、この列の **デコードされた** 値は、復号化されたメッセージを識別します。

- 検索結果をエクスポートするときに添付ファイルの暗号化を解除するだけでなく、検索結果をプレビューするときに復号化されたファイルをプレビューすることもできます。 権限で保護された電子メール メッセージは、エクスポート後にのみ表示できます。

- 現時点では、検索結果をエクスポートするときの暗号化解除機能には、SharePoint サイトとOneDrive for Business サイトからの暗号化されたコンテンツは含まれません。 ただし、Microsoft 暗号化テクノロジで暗号化され、SharePoint Online およびOneDrive for Businessに保存されているドキュメントのサポートは間もなく行われます。

- 他のユーザーが RMS で保護されたメッセージと暗号化されたファイルの添付ファイルを復号化できないようにする必要がある場合は、(組み込みの電子情報開示マネージャーの役割グループをコピーして) カスタム役割グループを作成し、カスタム ロール グループから RMS 復号化管理ロールを削除する必要があります。 次に、メッセージを復号化しないユーザーをカスタム ロール グループのメンバーとして追加します。
  
### <a name="filenames-of-exported-items"></a>エクスポートされたアイテムのファイル名
  
- ローカル コンピューターにエクスポートされる電子メール メッセージとサイト ドキュメントの完全なパス名には、(オペレーティング システムによって) 260 文字の制限があります。 エクスポートされたアイテムの完全なパス名には、アイテムの元の場所と、検索結果のダウンロード先となるローカル コンピューター上のフォルダーの場所が含まれます。 たとえば、電子情報開示エクスポート ツールで検索結果をダウンロードするように  `C:\Users\Admin\Desktop\SearchResults` 指定した場合、ダウンロードした電子メール アイテムの完全なパス名は次のようになります  `C:\Users\Admin\Desktop\SearchResults\ContentSearch1\03.15.2017-1242PM\Exchange\sarad@contoso.com (Primary)\Top of Information Store\Inbox\Insider trading investigation.msg`。

- 260 文字の制限を超えた場合、アイテムの完全なパス名は、次に基づいて切り捨てられます。

  - 完全なパス名が 260 文字を超える場合、ファイル名は制限を下回るように短縮されます。切り捨てられたファイル名 (ファイル拡張子を除く) は 8 文字以下になることに注意してください。

  - ファイル名を短くしても完全なパス名が長すぎる場合、アイテムは現在の場所から親フォルダーに移動されます。 パス名が長すぎる場合は、ファイル名を短くし、必要に応じて親フォルダーにもう一度移動するプロセスが繰り返されます。 このプロセスは、完全なパス名が 260 文字の制限の下になるまで繰り返されます。

  - 切り捨てられた完全パス名が既に存在する場合は、ファイル名の末尾にバージョン番号が追加されます。たとえば、. `statusmessage(2).msg`

    この問題を軽減するには、短いパス名を持つ場所に検索結果をダウンロードすることを検討してください。たとえば、検索結果を名前付きの  `C:\Results` フォルダーにダウンロードすると、エクスポートされたアイテムのパス名に追加する文字数が、名前付きの  `C:\Users\Admin\Desktop\Results`フォルダーにダウンロードされるよりも少なくなります。

- サイト ドキュメントをエクスポートするときに、ドキュメントの元のファイル名が変更される可能性もあります。 これは、保留になっているSharePointまたはOneDrive for Business サイトから削除されたドキュメントに対して特に発生します。 保留中のサイト上のドキュメントが削除されると、削除されたドキュメントはサイトの保持保持ライブラリに自動的に移動されます (サイトが保留になったときに作成されました)。 削除されたドキュメントが保持保持ライブラリに移動されると、ランダムに生成され、一意の ID がドキュメントの元のファイル名に追加されます。 たとえば、ドキュメントのファイル名が  `FY2017Budget.xlsx` 後で削除され、保持保持ライブラリに移動された場合、保持保持ライブラリに移動されるドキュメントのファイル名は次のように  `FY2017Budget_DEAF727D-0478-4A7F-87DE-5487F033C81A2000-07-05T10-37-55.xlsx`変更されます。 保持保持ライブラリ内のドキュメントがコンテンツ検索のクエリと一致し、その検索の結果をエクスポートする場合、エクスポートされたファイルには変更されたファイル名が含まれます。この例では、エクスポートされたドキュメントのファイル名は次のようになります  `FY2017Budget_DEAF727D-0478-4A7F-87DE-5487F033C81A2000-07-05T10-37-55.xlsx`。

    保留中のサイト上のドキュメントが変更され (サイト内のドキュメント ライブラリのバージョン管理が有効になっている場合)、ファイルのコピーが保持保持ライブラリに自動的に作成されます。 この場合、ランダムに生成された一意の ID も、保持保持ライブラリにコピーされるドキュメントのファイル名に追加されます。

    保持保持ライブラリに移動またはコピーされるドキュメントのファイル名は、ファイル名の競合を防ぐためです。 サイトにホールドを配置する方法と保持保持ライブラリの詳細については、「[SharePoint Server 2016 でのインプレースホールドの概要](https://support.office.com/article/5e400d68-cd51-444a-8fe6-e4df1d20aa95)」を参照してください。

### <a name="miscellaneous"></a>その他
  
- 電子情報開示エクスポート ツールを使用して検索結果をダウンロードすると、次のエラーが表示される可能性があります。`System.Net.WebException: The remote server returned an error: (412) The condition specified using HTTP conditional header(s) is not met.`これは一時的なエラーであり、通常はAzure Storageの場所で発生します。 この問題を解決するには、 [検索結果のダウンロードを](#step-2-download-the-search-results)再試行します。これにより、電子情報開示エクスポート ツールが再起動されます。

- すべての検索結果とエクスポート レポートは、コンテンツ検索と同じ名前のフォルダーに含まれます。 エクスポートされたメール メッセージは、**Exchange** という名前のフォルダーにあります。 ドキュメントは、**SharePoint** という名前のフォルダーにあります。

- SharePointおよびOneDrive for Business サイト上のドキュメントのファイル システム メタデータは、ドキュメントがローカル コンピューターにエクスポートされるときに保持されます。 つまり、作成日や最終更新日などのドキュメントのプロパティは、ドキュメントがエクスポートされる時に変更されません。

- 検索結果に、検索クエリに一致するSharePointのリスト アイテムが含まれている場合は、検索クエリとリスト内の添付ファイルに一致するアイテムに加えて、リスト内のすべての行がエクスポートされます。 この動作の理由は、検索結果に返されるリスト アイテムのコンテキストを提供するためです。 追加のリスト アイテムと添付ファイルを使用すると、エクスポートされたアイテムの数が検索結果の元の見積もりと異なる場合があります。
