---
title: 異常検出アラートを調査する
f1.keywords:
- NOCSH
ms.author: v-tophillips
author: v-tophillips
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.collection: m365-security-compliance
localization_priority: Priority
search.appverid:
- MOE150
- MET150
description: 異常検出アラートを調査する。
ms.openlocfilehash: fd596e087bda442a36aa1fcf7d7b2ddafccfb106
ms.sourcegitcommit: d817a3aecb700f7227a05cd165ffa7dbad67b09d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/29/2021
ms.locfileid: "53649733"
---
# <a name="investigate-anomaly-detection-alerts"></a>異常検出アラートを調査する

 Microsoft アプリ ガバナンスでは、悪意のあるアクティビティに対するセキュリティ検出とアラートが提供されます。 このガイドの目的は、調査と修復のタスクを支援するために、各アラートについての一般的で実用的な情報を提供することです。 このガイドに記載されているのは、アラートがトリガーされる条件に関する一般的な情報です。 異常検出は本質的に不明確であるため、標準とは異なる動作が発生した場合にのみトリガーされます。 最後に、一部のアラートはプレビュー段階である可能性があるため、定期的に公式ドキュメントで更新されたアラートの状態を確認してください。

## <a name="mitre-attck"></a>MITRE ATT&CK

アプリ ガバナンス アラートとよく知られた MITRE ATT&CK マトリックスとの間の関係を簡単にマップできるよう、MITRE ATT&CK の対応する方策ごとにアラートを分類しました。 この追加の参照により、アプリ ガバナンス アラートがトリガーされたときに使用されている可能性のある疑わしい攻撃手法を容易に把握できます。

このガイドでは、次のカテゴリの アプリ ガバナンス アラートの調査と修復に関する情報を提供します。

- 初期アクセス
- 実行
- 永続性
- 特権エスカレーション
- 防御回避
- 資格情報へのアクセス
- コレクション
- 流出
- 影響

## <a name="security-alert-classifications"></a>セキュリティ アラートの分類

適切な調査に従って、すべての アプリ ガバナンス アラートは、次のアクティビティの種類のいずれかとして分類することができます。

- 真陽性 (TP): 悪意が確認されたアクティビティに関するアラート。
- 問題のない真陽性: 侵入テストや他の承認された疑わしいアクションなど、疑わしいが悪意のないアクティビティに関するアラート。
- 偽陽性 (FP): 悪意のないアクティビティに関するアラート。

## <a name="general-investigation-steps"></a>一般的な調査手順

推奨アクションを適用する前に、潜在的な脅威をより明確に理解するためにアラートの種類を調査するとき、次の一般的なガイドラインを使用します。

- アプリの重大度レベルを確認し、テナント内の他のアプリと比較します。 確認は、最も大きなリスクをもたらすテナント内のアプリを特定するのに役立ちます。
- TP を識別する場合は、アプリのすべてのアクティビティを確認して、その影響について理解を深めます。たとえば、次のアプリ情報を確認します。

  - 付与されているアクセス権のスコープ
  - 異常な動作  
  - IP アドレスと場所

## <a name="initial-access-alerts"></a>初期アクセス アラート

このセクションでは、悪意のあるアプリが組織への足掛かりを得ようとしている可能性があることを示すアラートについて説明します。  

### <a name="encoded-app-name-with-suspicious-consent-scopes"></a>疑わしいコンテンツ スコープのエンコードされたアプリ名

**重要度:** 中

**説明**: この検出により、疑わしいコンテンツ スコープに要求され、Graph API を介してユーザーのメール フォルダーにアクセスした、Unicode またはエンコードされた文字などが使用されている OAuth アプリが示されます。 このアラートは、攻撃者がユーザーに誤解を与えて悪意のあるアプリに同意させることができるように、悪意のあるアプリを既知の信頼できるアプリとしてカモフラージュさせようとしていることを示す可能性があります。

**TP または FP?**

- **TP**: OAuth アプリが不明なソースから配信された疑わしいスコープで表示名をエンコードしたことを確認できる場合、真陽性が示されます。  

  **推奨されるアクション**: このアプリによって要求されたアクセス許可のレベルと、アクセスを許可したユーザーを確認します。 調査に基づいて、このアプリへのアクセスの禁止を選択できます。

  アプリへのアクセスを禁止するには、 [OAuth アプリ] ページで、禁止するアプリが表示されている行の禁止アイコンを選択します。 自分がインストールして承認したアプリが禁止されたことをユーザーに通知するかどうかを選択できます。 その通知により、ユーザーは、アプリが無効になり、接続されているアプリにアクセスできなくなることがわかります。 ユーザーに知らせたくない場合は、ダイアログの [この禁止されたアプリにアクセス許可を付与したユーザーに通知を送信します] の選択を解除します。 アプリが使用禁止になることをアプリのユーザーに知らせることをお勧めします。

- **FP**: アプリの名前は誤解を与える可能性があるが、組織での正当なビジネス上の使用であることを確認した場合。

  **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

[危険な OAuth アプリを調査する](/cloud-app-security/investigate-risky-oauth)方法についてのチュートリアルに従います。

### <a name="oauth-app-with-read-scopes-have-suspicious-reply-url"></a>読み取りスコープを持つ OAuth アプリに疑わしい応答 URL がある

**重要度**: 中

**説明**: この検出により、Graph API を介した User.Read, People.Read, Contacts.Read, Mail.Read, Contacts.Read.Shared などによる疑わしい応答 URL へのリダイレクトの読み取りスコープのみを持つ OAuth アプリが示されます。 このアクティビティは、特権の少ないアクセス許可 (読み取りスコープなど) を持つ悪意のあるアプリがユーザー アカウントの偵察に悪用できることを示すことを試みます。

**TP または FP?**

- **TP**: 読み取りスコープを持つ OAuth アプリが不明なソースから配信されており、疑わしい URL にリダイレクトすることを確認できる場合、真陽性が示されます。

  **推奨されるアクション**: 応答 URL と、アプリによって要求されたスコープを確認します。 調査に基づいて、このアプリへのアクセスの禁止を選択できます。 このアプリによって要求されたアクセス許可のレベルと、アクセスを許可したユーザーを確認します。

  アプリへのアクセスを禁止するには、 [OAuth アプリ] ページで、禁止するアプリが表示されている行の禁止アイコンを選択します。 自分がインストールして承認したアプリが禁止されたことをユーザーに通知するかどうかを選択できます。 その通知により、ユーザーは、アプリが無効になり、接続されているアプリにアクセスできなくなることがわかります。 ユーザーに知らせたくない場合は、ダイアログの [この禁止されたアプリにアクセス許可を付与したユーザーに通知を送信します] の選択を解除します。 アプリが使用禁止になることをアプリのユーザーに知らせることをお勧めします。

- **B-TP**: 調査の後、アプリに組織での正当なビジネス上の用途があることを確認できた場合。

  **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. アプリによって実行されるすべてのアクティビティを確認します。
1. アプリが疑わしいと思われる場合は、別のアプリ ストアでそのアプリの名前と応答 URL を調査することをお勧めします。 アプリ ストアを確認するときは、次の種類のアプリに注目します。
   - 最近作成されたアプリ。
   - 疑わしい応答 URL を持つアプリ。
   - 最近更新されていないアプリ。 更新されていない場合、アプリがもうサポートされていないことを示している可能性があります。
1. アプリがまだ疑わしいと思われる場合は、そのアプリの名前、発行元の名前、および応答 URL をオンラインで調べることができます  

### <a name="app-with-unusual-display-name-and-unusual-tld-inreply-domain"></a>応答ドメインに通常と異なる表示名と通常と異なる TLD を持つアプリ  

**重要度**: 中  

**説明**

この検出により、通常と異なる表示名を持つアプリを特定し、Graph API 経由で通常とは異なるトップレベル ドメイン  (TLD) を持つ疑わしい応答ドメインにリダイレクトします。 これは、攻撃者がユーザーに誤解を与えて悪意のある、または危険なアプリに同意させることができるように、悪意のある、または危険なアプリを既知の信頼できるアプリとしてカモフラージュさせようとしていることを示す可能性があります。  

**TP または FP?**

- **TP**: 通常と異なる表示名を持つアプリが不明なソースから配信されており、通常と異なるトップレベル ドメインを持つ疑わしいドメインにリダイレクトします  

    **推奨されるアクション**: アプリの表示名と応答ドメインを確認します。 調査に基づいて、このアプリへのアクセスの禁止を選択できます。 このアプリによって要求されたアクセス許可のレベルと、アクセスを許可したユーザーを確認します。

- **FP**: 調査の後、アプリに組織での正当なビジネス上の用途があることを確認できた場合。

    **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

アプリによって実行されるすべてのアクティビティを確認します。 アプリが疑わしいと思われる場合は、別のアプリ ストアでそのアプリの名前と応答ドメインを調査することをお勧めします。 アプリ ストアを確認するときは、次の種類のアプリに注目します。

- 最近作成されたアプリ
- 通常と異なる表示名を持つアプリ
- 疑わしい応答ドメインを持つアプリ。

アプリがまだ疑わしいと思われる場合は、そのアプリの表示名および応答ドメインをオンラインで調べることができます。

## <a name="persistence-alerts"></a>永続性アラート

このセクションでは、悪意のあるアクターが組織への足掛かりを維持しようとしている可能性があることを示すアラートについて説明します。

### <a name="app-with-suspicious-oauth-scope-creates-inbox-rule"></a>疑わしい OAuth スコープを含むアプリが受信トレイ ルールを作成する  

**重要度**: 中

**MITRE ID**: T1137.005、T1114  

この検出により、疑わしいスコープに同意し、疑わしい受信トレイ ルールを作成して、Graph API を介してユーザーのメール フォルダーおよびメッセージにアクセスした OAuth アプリが示されます。 すべてまたは特定のメールを別のメール アカウントに転送し、Graph がメールにアクセスして別のメール アカウントに送信するために呼び出すなどの受信トレイ ルールは、組織から情報を抽出する試みである可能性があります。  

**TP または FP?**

- **TP**: 受信トレイ ルールが OAuth のサードパーティ製のアプリによって作成され、疑わしいスコープが不明なソースから配信されていることを確認できる場合、真陽性が示されます。

  **推奨されるアクション**: アプリを無効にして削除し、パスワードをリセットして、受信トレイ ルールを削除します。

  Azure Active Directory を使用してパスワードをリセットする方法に関するチュートリアルと、受信トレイ ルールを削除する方法に関するチュートリアルに従います。

- **FP**: アプリが正当な理由で新規または個人の外部メール アカウントに受信トレイ ルールを作成したことを確認できる場合。

  **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. アプリによって実行されるすべてのアクティビティを確認します。
1. アプリによって付与されたスコープを確認します。
1. アプリによって作成された受信トレイ ルール アクションと条件を確認します。

### <a name="app-accessed-from-unusual-location-post-certificate-update"></a>証明書の更新後、通常と異なる場所からアプリへのアクセスがある

**重要度**: 低

**MITRE ID**: T1098

この検知機能は、基幹業務 (LOB) アプリの証明書や秘密情報が更新され、証明書の更新後数日以内に、最近は見ていない、あるいは過去にはアクセスしたことのない通常と異なる場所からアプリケーションにアクセスがあった場合に警告を発します。

**TP または FP?**

- **TP**: 基幹業務アプリが通常と異なる場所からアクセスし、Graph API 経由で通常と異なるアクティビティを実行したことが確認できた場合。

    **推奨されるアクション**: アプリを一時的に無効にし、パスワードをリセットしてからアプリを再度有効にします。

- **FP**: 基幹業務アプリが通常と異なる場所から正当な目的でアクセスし、通常と異なるアクティビティを実行していないことが確認できた場合。

    **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. このアプリで実行されるすべてのアクティビティを確認します。
1. アプリによって付与されたスコープを確認します。
1. このアプリに関連するユーザー アクティビティを確認します。

### <a name="app-accessed-from-unusual-location-made-anomalous-graph-calls-post-certificate-update"></a>通常と異なる場所からアクセスしたアプリで、証明書の更新後に異常な Graph 呼び出しがある

**重要度**: 中

**MITRE ID**: T1098

この検知機能は、基幹業務 (LOB) アプリの証明書や秘密情報が更新され、証明書の更新後数日以内に、最近は見ていない、あるいは過去にはアクセスしたことのない通常と異なる場所からアプリケーションにアクセスがあった場合や、機械学習アルゴリズムを使用して Graph API 経由で通常と異なるアクティビティや使用状況が観測された場合に警告を発します。

**TP または FP?**

- **TP**: 基幹業務アプリが、通常と異なる場所から Graph API 経由で通常と異なるアクティビティまたは使用を実行したことが確認できた場合。

    **推奨されるアクション**: アプリを一時的に無効にし、パスワードをリセットしてからアプリを再度有効にします。

- **FP**: 基幹業務アプリが通常と異なる場所から正当な目的でアクセスし、通常と異なるアクティビティを実行していないことが確認できた場合。

    **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. このアプリで実行されるすべてのアクティビティを確認します。
1. アプリによって付与されたスコープを確認します。
1. このアプリに関連するユーザー アクティビティを確認します。

## <a name="collection-alerts"></a>コレクションのアラート

このセクションでは、悪意のあるアクターが目標に対して関心のあるデータを組織から収集しようとしている可能性があることを示すアラートについて説明します。

### <a name="app-made-anomalous-graph-calls-to-read-e-mail"></a>アプリがメールを読み取るための匿名の Graph 呼び出しを実行した

**重要度**: 中

**MITRE ID**: T1114

この検出により、基幹業務 (LOB) OAuth アプリが、Graph API を通してユーザーの異常な、および大量のメール フォルダおよびメッセージにアクセスしたことが示されます。これは、組織のへの侵害が試行されたことを示す可能性があります。

**TP または FP?**

- **TP**: Graph による異常なアクティビティが基幹業務 (LOB) OAuth アプリによって実行されたことを確認できる場合、真陽性が示されます。

  **推奨されるアクション**: アプリを一時的に無効にし、パスワードをリセットしてからアプリを再度有効にします。 Azure Active Directory を使用してパスワードをリセットする方法に関するチュートリアルに従います。

- **FP**: アプリが異常に多い量の Graph 呼び出しを行うよう意図されていることを確認できる場合。

  **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. メールを読み取り、ユーザーのメールに関する機密情報の収集を試行するための Graph のその他のアクティビティをさらに理解するには、このアプリによって実行されたイベントのアクティビティ ログを確認します。
1. 予期しない資格情報がアプリに追加されないか監視します。

### <a name="app-creates-inbox-rule-and-made-unusual-email-searches-activities"></a>アプリが受信トレイ ルールを作成し、通常と異なるメール検索アクティビティを行いました。

**重要度**: 中

**MITRE ID**: T1137、T1114  

この検出により、アプリが高い権限を持つスコープに同意していること、疑わしい受信トレイ ルールを作成していること、Graph API 経由でユーザーのメール フォルダーで通常と異なるメール検索アクティビティを行っていることを特定します。 これは、攻撃者が Graph API 経由で組織からの特定のメールを検索し、収集しようとするなど、組織への侵入を試みていることを示している可能性があります。

**TP または FP?**

- **TP**: 高い権限を持つスコープを持つ OAuth アプリによって Graph API 経由で行われた特定のメールの検索と収集が確認でき、そのアプリが未知のソースから配信されている場合。

    **推奨されるアクション**: アプリを無効にして削除し、パスワードをリセットして、受信トレイ ルールを削除します。

- **FP**: アプリが Graph API 経由で特定のメールの検索と収集を実行し、正当な理由で新規または個人の外部メール アカウントへの受信トレイ ルールを作成したことが確認できる場合。

    **推奨されるアクション**: アラートを無視します。

**攻撃対象を理解する**

1. アプリによって実行されるすべてのアクティビティを確認します。
1. アプリによって付与されたスコープを確認します。
1. アプリによって作成された任意の受信トレイ ルール アクションを確認します。
1. アプリが実行する任意のメール検索アクティビティを確認します。
