---
title: 電子情報開示ソリューション シリーズのデータ流出シナリオ - 検索と消去
f1.keywords:
- NOCSH
ms.author: v-tophillips
author: v-tophillips
manager: laurawi
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
ms.localizationpriority: medium
ms.collection: M365-security-compliance
search.appverid:
- MET150
ms.assetid: d945f7dd-f62f-4ca7-b3e7-469824cfd493
description: 電子情報開示ツールと検索ツールを使用して、組織内のデータ流出インシデントを管理して対応します。
ms.openlocfilehash: 9be20d6c8eab99206a5510be6f21d3ca24114e0e
ms.sourcegitcommit: e50c13d9be3ed05ecb156d497551acf2c9da9015
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2022
ms.locfileid: "65086955"
---
# <a name="ediscovery-solution-series-data-spillage-scenario---search-and-purge"></a>電子情報開示ソリューション シリーズ: データ流出シナリオ - 検索と消去

[!include[Purview banner](../includes/purview-rebrand-banner.md)]

 **データの流出とは何か、なぜ気にする必要がありますか?** データの流出は、機密ドキュメントが信頼されていない環境にリリースされたときです。 データ流出インシデントが検出された場合は、流出のサイズと場所をすばやく評価し、その周囲のユーザー アクティビティを調べてから、流出したデータをシステムから完全に消去することが重要です。
  
## <a name="data-spillage-scenario"></a>データ流出シナリオ

あなたは Contoso のリード情報セキュリティ担当者です。 データ流出の状況が通知されます。従業員は、知らずのうちに機密性の高い文書をメールで複数のユーザーと共有しました。 このドキュメントを内部および外部で受け取ったユーザーをすばやく評価する必要があります。 特定されたら、ケースの結果を他の調査担当者と共有して確認し、Office 365からデータを完全に削除します。 調査が完了したら、今後の参照のために、完全な削除の証拠とその他のケースの詳細を含むレポートを生成する必要があります。
  
### <a name="scope-of-this-article"></a>この記事の範囲

このドキュメントでは、Microsoft 365からメッセージを完全に削除して、アクセスまたは回復できないようにする方法の一覧を示します。 メッセージを削除し、削除されたアイテムの保持期間が経過するまで回復可能にするには、「 [組織内の電子メール メッセージを検索して削除する](search-for-and-delete-messages-in-your-organization.md)」を参照してください。
  
## <a name="workflow-for-managing-data-spillage-incidents"></a>データ流出インシデントを管理するためのワークフロー

データ流出インシデントを管理する方法を次に示します。

![データ流出インシデントを管理するための 8 段階のワークフロー。](../media/O365-eDiscoverySolutions-DataSpillage-workflow.png)
  
[(省略可能)手順 1: ケースにアクセスできるユーザーを管理し、コンプライアンスの境界を設定する](#optional-step-1-manage-who-can-access-the-case-and-set-compliance-boundaries)<br/>
[手順 2: 電子情報開示ケースを作成する](#step-2-create-an-ediscovery-case)<br/>
[手順 3: 流出したデータを検索する](#step-3-search-for-the-spilled-data)<br/>
[手順 4: ケースの結果を確認して検証する](#step-4-review-and-validate-case-findings)<br/>
[手順 5: メッセージ トレース ログを使用して、流出したデータがどのように共有されたかを確認する](#step-5-use-message-trace-log-to-check-how-spilled-data-was-shared)<br/>
[手順 6: メールボックスを準備する](#step-6-prepare-the-mailboxes)<br/>
[手順 7: 流出したデータを完全に削除する](#step-7-permanently-delete-the-spilled-data)<br/>
[手順 8: 削除の証明を確認し、提出し、監査する](#step-8-verify-provide-a-proof-of-deletion-and-audit)<br/>

## <a name="things-to-know-before-you-start"></a>開始する前に知っておくべきこと

- この記事で説明するデータ流出ワークフローでは、Microsoft Teamsのチャット メッセージは削除されません。 Teams チャット メッセージを検索および削除するには、「[Teamsでチャット メッセージを検索および消去](search-and-delete-Teams-chat-messages.md)する」を参照してください。

- メールボックスが保留中の場合、削除されたメッセージは、保持期間の有効期限が切れるか、保持が解放されるまで回復可能なアイテム フォルダーに残ります。 [手順 6](#step-6-prepare-the-mailboxes) では、メールボックスから保留を削除する方法について説明します。 保留を削除する前に、レコード管理または法務部門に問い合わせてください。 組織には、メールボックスの保留またはデータ流出インシデントが優先されるかどうかを定義するポリシーが含まれている場合があります。 

- データ流出調査員がケースにアクセスできるユーザーを検索および管理できるユーザー メールボックスを制御するには、コンプライアンス境界を設定し、 [手順 1](#optional-step-1-manage-who-can-access-the-case-and-set-compliance-boundaries) で説明するカスタムロール グループを作成します。 これを行うには、組織管理役割グループのメンバーであるか、ロール管理ロールを割り当てる必要があります。 自分または組織内の管理者がコンプライアンスの境界を既に設定している場合は、手順 1 をスキップできます。

- ケースを作成するには、電子情報開示マネージャーの役割グループのメンバーであるか、ケース管理ロールが割り当てられているカスタム役割グループのメンバーである必要があります。 メンバーでない場合は、Microsoft 365管理者に[電子情報開示マネージャーの役割グループに追加](assign-ediscovery-permissions.md)するよう依頼します。

- コンテンツ検索を作成して実行するには、電子情報開示管理者役割グループのメンバーであるか、コンプライアンス検索の管理役割が割り当てられている必要があります。 メッセージを削除するには、Organization Management 役割グループのメンバーであるか、検索と消去の管理役割が割り当てられている必要があります。 ユーザーを役割グループに追加する方法については、「 [電子情報開示アクセス許可の割り当て](./assign-ediscovery-permissions.md)」を参照してください。

- 手順 8 で監査ログの電子情報開示アクティビティを検索するには、組織の監査を有効にする必要があります。 過去 90 日以内に実行されたアクティビティを検索できます。 監査を有効にして使用する方法の詳細については、手順 8 の「 [データ流出調査プロセスの監査](#auditing-the-data-spillage-investigation-process) 」セクションを参照してください。

## <a name="optional-step-1-manage-who-can-access-the-case-and-set-compliance-boundaries"></a>(省略可能)手順 1: ケースにアクセスできるユーザーを管理し、コンプライアンスの境界を設定する

組織のプラクティスに応じて、データ流出インシデントを調査し、コンプライアンス境界を設定するために使用される電子情報開示ケースにアクセスできるユーザーを制御する必要があります。 これを行う最も簡単な方法は、Microsoft Purview コンプライアンス ポータルで既存の役割グループのメンバーとして調査者を追加し、電子情報開示ケースのメンバーとして役割グループを追加することです。 組み込みの電子情報開示ロール グループと、電子情報開示ケースにメンバーを追加する方法については、「電子情報開示 [アクセス許可の割り当て](assign-ediscovery-permissions.md)」を参照してください。
  
組織のニーズに合わせて新しい役割グループを作成することもできます。 たとえば、組織内のデータ流出調査担当者のグループが、すべてのデータ流出ケースにアクセスして共同作業を行う必要がある場合があります。 これを行うには、"Data Spillage Investigator" 役割グループを作成し、適切なロール (エクスポート、RMS 復号化、レビュー、プレビュー、コンプライアンス検索、ケース管理) を割り当て、データ流出調査担当者を役割グループに追加してから、データ流出電子情報開示ケースのメンバーとして役割グループを追加します。 これを行う方法の詳細な手順については、「[Office 365での電子情報開示調査のコンプライアンス境界の設定](set-up-compliance-boundaries.md)」を参照してください。 
  
## <a name="step-2-create-an-ediscovery-case"></a>手順 2: 電子情報開示ケースを作成する

電子情報開示ケースは、データ流出調査を管理する効果的な方法を提供します。 手順 1 で作成した役割グループにメンバーを追加し、新しい電子情報開示ケースのメンバーとして役割グループを追加し、反復検索を実行して流出データを検索し、レポートをエクスポートして共有し、ケースの状態を追跡し、必要に応じてケースの詳細を参照することができます。 データ流出インシデントに使用される電子情報開示ケースの名前付け規則を確立することを検討し、必要に応じて将来検索して参照できるように、ケース名と説明にできるだけ多くの情報を提供することを検討してください。
  
新しいケースを作成するには、セキュリティとコンプライアンス センターで電子情報開示を使用できます。 [電子情報開示 (Standard)](get-started-core-ediscovery.md#step-3-create-a-ediscovery-standard-case) を使用した概要の「新しいケースの作成」を参照してください。
  
## <a name="step-3-search-for-the-spilled-data"></a>手順 3: 流出したデータを検索する

ケースとマネージド アクセスを作成したので、ケースを使用して繰り返し検索して、流出したデータを検索し、流出したデータを含むメールボックスを特定できます。 [手順 7](#step-7-permanently-delete-the-spilled-data). で同じメッセージを削除するために電子メール メッセージを見つけるために使用したものと同じ検索クエリを使用します。
  
電子情報開示ケースに関連付けられたコンテンツ検索を作成するには、「電子情報開示 [(Standard) ケースでコンテンツを検索する」](search-for-content-in-core-ediscovery.md)を参照してください。
  
> [!IMPORTANT]
> 検索クエリで使用するキーワードには、検索対象の実際の流出データが含まれている場合があります。 たとえば、社会保障番号を含むドキュメントを検索し、それを検索キーワードとして使用する場合は、それ以上の流出を防ぐために、後でクエリを削除する必要があります。 手順 8 [の「検索クエリの削除](#deleting-the-search-query) 」を参照してください。
  
## <a name="step-4-review-and-validate-case-findings"></a>手順 4: ケースの結果を確認して検証する

コンテンツ検索を作成したら、検索結果を確認して検証し、削除する必要がある電子メール メッセージのみで構成されていることを確認する必要があります。 コンテンツ検索では、検索結果をエクスポートせずに 1,000 件のメール メッセージのランダム サンプリングをプレビューして、データの流出を回避できます。 プレビューの制限事項の詳細については、 [コンテンツ検索の制限](limits-for-content-search.md)に関するページを参照してください。
  
メールボックスあたり 1,000 を超えるメールボックスまたは 100 を超えるメール メッセージを確認する場合は、日付範囲や送信者/受信者などの追加のキーワードや条件を使用して、最初の検索を複数の検索に分割し、各検索の結果を個別に確認できます。 [手順 7](#step-7-permanently-delete-the-spilled-data). でメッセージを削除するときに使用するすべての検索クエリをメモしておいてください。

流出したデータを含む電子メール メッセージが見つかると、メッセージの受信者を確認して、外部で共有されたかどうかを確認します。 メッセージをさらにトレースするには、メッセージ トレース ログを使用できるように、送信者情報と日付範囲を収集できます。 このプロセスについては、 [手順 5](#step-5-use-message-trace-log-to-check-how-spilled-data-was-shared) で説明します。

検索結果を確認した後、その結果を他のユーザーと共有して、セカンダリ レビューを行う必要がある場合があります。 手順 1 でケースに割り当てたユーザーは、電子情報開示と Microsoft Purview 電子情報開示 (プレミアム) の両方でケース コンテンツを確認し、ケースの結果を承認できます。 実際のコンテンツをエクスポートせずにレポートを生成することもできます。 この同じレポートは、 [手順 8](#step-8-verify-provide-a-proof-of-deletion-and-audit) で説明されている削除の証拠として使用することもできます。
  
 **統計レポートを生成するには:**
  
1. 電子情報開示ケースの **[検索** ] ページに移動し、レポートを生成する検索をクリックします。 
    
2. ポップアップ ページで、[ **その他の>エクスポート レポート**] をクリックします。
 
      レポートのエクスポート ページが表示されます。

    ![検索を選択し、ポップアップ ページで [その他>エクスポート レポート] をクリックします。](../media/O365-eDiscoverySolutions-DataSpillage-ExportReport1.png)
    
3. [認識 **できない形式を含むすべてのアイテム] が暗号化されているか、他の理由でインデックスが作成されていない** アイテムを選択し、[ **レポートの生成**] をクリックします。

4. 電子情報開示の場合は、[ **エクスポート** ] をクリックしてエクスポート ジョブの一覧を表示します。 作成したエクスポート ジョブを表示するには、[ **更新** ] をクリックして一覧を更新する必要がある場合があります。

5. エクスポート ジョブをクリックし、ポップアップ ページで [レポートの **ダウンロード** ] をクリックします。
 
    ![[エクスポート] ページでエクスポートをクリックし、[レポートのダウンロード] をクリックします。](../media/O365-eDiscoverySolutions-DataSpillage-ExportReport2.png)

**エクスポートの概要** レポートには、結果と検索結果のサイズで見つかった場所の数が含まれます。 これを使用して、削除後に生成されたレポートと比較し、削除の証拠として提供できます。 **結果** レポートには、メールが読み取られた場合の件名、送信者、受信者、各メッセージの日付、サイズなど、検索結果のより詳細な概要が含まれています。 このレポートのいずれかの詳細に実際の流出データが含まれている場合は、調査が完了したら、Results.csv ファイルを完全に削除してください。

レポートのエクスポートの詳細については、「 [コンテンツ検索レポートをエクスポートする](export-a-content-search-report.md)」を参照してください。
    
## <a name="step-5-use-message-trace-log-to-check-how-spilled-data-was-shared"></a>手順 5: メッセージ トレース ログを使用して、流出したデータがどのように共有されたかを確認する

データが流出した電子メールが共有されたかどうかをさらに調査するには、必要に応じて、手順 4. で収集した送信者情報と日付範囲情報を使用してメッセージ トレース ログにクエリを実行できます。 メッセージ トレースの保持期間は、リアルタイム データの場合は 30 日間、履歴データの場合は 90 日間です。
  
セキュリティとコンプライアンス センターでメッセージ トレースを使用することも、対応するコマンドレットExchange Online PowerShell で使用することもできます。 メッセージ トレースでは、返されるデータの完全性に関する完全な保証は提供されないことに注意してください。 メッセージ トレースの使用の詳細については、次を参照してください。 
  
- [セキュリティとコンプライアンス センターのメッセージ追跡](../security/office-365-security/message-trace-scc.md)
    
- [セキュリティ & コンプライアンス センターの新しいメッセージ トレース](https://techcommunity.microsoft.com/t5/exchange-team-blog/new-message-trace-in-office-365-security-038-compliance-center/ba-p/607893)
    
## <a name="step-6-prepare-the-mailboxes"></a>手順 6: メールボックスを準備する

検索結果に削除する必要があるメッセージのみが含まれていることを確認して検証したら、流出したデータを削除するときに手順 7 で使用する影響を受けるメールボックスの電子メール アドレスの一覧を収集する必要があります。 また、流出したデータを含むメールボックスで単一アイテムの回復が有効になっているかどうか、またはそれらのメールボックスのいずれかが保留になっている場合に応じて、電子メール メッセージを完全に削除する前にメールボックスを準備する必要がある場合もあります。
  
### <a name="get-a-list-of-addresses-of-mailboxes-with-spilled-data"></a>データが流出したメールボックスのアドレスの一覧を取得する

データが流出したメールボックスの電子メール アドレスの一覧を収集するには、2 つの方法があります。

**オプション 1: データが流出したメールボックスのアドレスの一覧を取得する**

1. 電子情報開示ケースを開き、[ **検索** ] ページに移動し、適切なコンテンツ検索を選択します。 
    
2. ポップアップ ページで、[ **結果の表示**] をクリックします。
    
3. **[個々の結果]** ドロップダウン リストで、**[検索の統計情報]** をクリックします。
    
4. [ **種類** ] ドロップダウン リストで、[ **上位の場所**] をクリックします。
    
    ![検索統計情報の [上位の場所] ページで、検索結果を含むメールボックスの一覧を取得します。](../media/O365-eDiscoverySolutions-DataSpillage-TopLocations.png)

    検索結果を含むメールボックスの一覧が表示されます。 検索クエリに一致する各メールボックス内のアイテムの数も表示されます。
    
5. 一覧の情報をコピーしてファイルに保存するか、[ **ダウンロード** ] をクリックして情報を CSV ファイルにダウンロードします。 
    
**オプション 2: エクスポート レポートからメールボックスの場所を取得する**

[手順 4](#step-4-review-and-validate-case-findings). でダウンロードしたエクスポートの概要レポートを開きます。 レポートの最初の列で、各メールボックスの電子メール アドレスが **[場所]** に一覧表示されます。
  
### <a name="prepare-the-mailboxes-so-you-can-delete-the-spilled-data"></a>流出したデータを削除できるようにメールボックスを準備する

単一アイテムの回復が有効になっている場合、またはメールボックスが保留になっている場合、完全に削除された (削除された) メッセージは回復可能なアイテム フォルダーに保持されます。 そのため、流出したデータを消去する前に、既存のメールボックスの構成を確認し、単一アイテムの回復を無効にし、保留ポリシーまたはアイテム保持ポリシーを削除する必要があります。 一度に 1 つのメールボックスを準備し、異なるメールボックスで同じコマンドを実行するか、PowerShell スクリプトを作成して複数のメールボックスを同時に準備できることに注意してください。

- 単一アイテムの回復が有効になっているか、メールボックスが保留になっているか、アイテム保持ポリシーに割り当てられているかどうかを確認する方法については、「手順 1: [メールボックス](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#step-1-collect-information-about-the-mailbox) に関する情報を収集する」を参照してください。 

- 単一アイテムの回復を無効にする手順については、「保留中のクラウドベースのメールボックス [の回復可能なアイテム フォルダー内のアイテムを削除](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#step-2-prepare-the-mailbox) する」の「手順 2: メールボックスを準備する」を参照してください。 

- メールボックスから保留ポリシーまたはアイテム保持ポリシーを削除する方法については、「保留中 [のクラウドベースのメールボックスの回復可能なアイテム フォルダー内のアイテムを削除](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#step-3-remove-all-holds-from-the-mailbox) する」の「手順 3: メールボックスからすべての保留を削除する」を参照してください。 

- 任意の種類の保留が削除された後にメールボックスに配置される遅延ホールドを削除する手順については、「保留中 [のクラウドベースのメールボックスの回復可能なアイテム フォルダー内の](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#step-4-remove-the-delay-hold-from-the-mailbox) アイテムを削除する」の「手順 4: メールボックスから遅延ホールドを削除する」を参照してください。

> [!IMPORTANT]
> 保留ポリシーまたはアイテム保持ポリシーを削除する前に、レコード管理または法務部門に問い合わせてください。 組織には、保留中のメールボックスとデータ流出インシデントのどちらが優先されるかを定義するポリシーがある場合があります。 
  
流出したデータが完全に削除されたことを確認した後は、メールボックスを以前の構成に戻してください。 [手順 7](#step-7-permanently-delete-the-spilled-data) の詳細を参照してください。

## <a name="step-7-permanently-delete-the-spilled-data"></a>手順 7: 流出したデータを完全に削除する

手順 6 で収集して準備したメールボックスの場所と、手順 3 で作成および絞り込まれた検索クエリを使用して、流出したデータを含む電子メール メッセージを見つけて、流出したデータを完全に削除できるようになりました。  前述のように、メッセージを削除するには、組織管理役割グループのメンバーであるか、検索および消去管理ロールを割り当てる必要があります。 ユーザーを役割グループに追加する方法については、「 [電子情報開示アクセス許可の割り当て](./assign-ediscovery-permissions.md)」を参照してください。

流出したメッセージを削除するには、「 [電子メール メッセージの検索と削除](search-for-and-delete-messages-in-your-organization.md)」を参照してください。

流出したデータを削除する場合は、次の制限に注意してください。

- 検索と消去アクションを実行してアイテムを削除するために使用できる検索内のメールボックスの最大数は 50,000 です。 手順 3 で作成した検索で 50,000 を超えるメールボックスが検索された場合、消去操作は失敗します。 1 回の検索で 50,000 個を超えるメールボックスを検索するのは、通常、組織内のすべてのメールボックスを検索に含めるように構成した場合です。 この制限は、検索クエリに一致するアイテムが 50,000 個未満のメールボックスに含まれている場合でも適用されます。

- メールボックスごとに最大 10 個のアイテムを一度に削除できます。メッセージを検索および削除する機能はインシデント対応ツールとして作られているので、この制限によってメールボックスからメッセージをすばやく削除できます。これは、ユーザーのメールボックスをクリーン アップするための機能ではありません。

> [!IMPORTANT]
> 電子情報開示 (プレミアム) ケースのレビュー セット内のメール アイテムは、この記事の手順で削除することはできません。 これは、レビュー セット内のアイテムが、ライブ サービス内のアイテムのコピーであり、Azure Storageの場所にコピーおよび保存されるためです。 つまり、手順 3. で作成したコンテンツ検索では返されません。 レビュー セット内のアイテムを削除するには、レビュー セットが含まれている電子情報開示 (プレミアム) ケースを削除する必要があります。 詳細については、「[Close or delete an eDiscovery (Premium) case (電子情報開示 (プレミアム) ケースを閉じるか、または削除する)](close-or-delete-case.md)」を参照してください。
  
## <a name="step-8-verify-provide-a-proof-of-deletion-and-audit"></a>手順 8: 削除の証明を確認し、提出し、監査する

データ流出インシデントを管理するワークフローの最後の手順は、電子情報開示ケースに移動し、そのデータを削除するために使用したのと同じ検索クエリを再実行して、結果が返されていないことを確認することで、流出したデータがメールボックスから完全に削除されたことを確認することです。 流出したデータが完全に削除されたことを確認したら、レポートをエクスポートし(元のレポートと共に)削除の証拠として含めることができます。 その後、ケース [を閉じて](close-reopen-delete-core-ediscovery-cases.md) 、今後参照する必要がある場合に再度開くことができます。 また、メールボックスを以前の状態に戻したり、流出したデータを検索するために使用される検索クエリを削除したり、データ流出インシデントの管理時に実行されたタスクの監査レコードを検索したりすることもできます。
  
### <a name="reverting-the-mailboxes-to-their-previous-state"></a>メールボックスを以前の状態に戻す

手順 6 でメールボックス構成を変更して、流出したデータが削除される前にメールボックスを準備した場合は、それらを以前の状態に戻す必要があります。 クラウド ベースのメールボックスの [回復可能なアイテム フォルダー内のアイテムを削除](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md#step-6-revert-the-mailbox-to-its-previous-state)する方法については、「手順 6: メールボックスを以前の状態に戻す」を参照してください。
  
### <a name="deleting-the-search-query"></a>検索クエリの削除

手順 3 で作成して使用した検索クエリのキーワードに、実際に流出したすべてのデータが含まれている場合は、さらにデータが流出しないように検索クエリを削除する必要があります。
  
1. セキュリティとコンプライアンス センターで電子情報開示ケースを開き、[ **検索** ] ページに移動し、適切なコンテンツ検索を選択します。

2. ポップアップ ページで、[削除] をクリック **します**。

    ![検索を選択し、ポップアップ ページで [削除] をクリックします。](../media/O365-eDiscoverySolutions-DataSpillage-DeleteSearch.png)

### <a name="auditing-the-data-spillage-investigation-process"></a>データ流出調査プロセスの監査

調査中に実行された電子情報開示アクティビティの監査ログを検索できます。 また、監査ログを検索して、手順 7 で実行した **New-ComplianceSearchAction -Purge** コマンドの監査レコードを返して、流出したデータを削除することもできます。 詳細については、以下を参照してください。

- [監査ログを検索する](search-the-audit-log-in-security-and-compliance.md)

- [監査ログで電子情報開示アクティビティを検索する](search-for-ediscovery-activities-in-the-audit-log.md)
